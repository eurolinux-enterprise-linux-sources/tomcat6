--- java/org/apache/coyote/http11/filters/ChunkedInputFilter.java.orig	2015-02-25 14:10:34.145784000 -0500
+++ java/org/apache/coyote/http11/filters/ChunkedInputFilter.java	2015-02-25 15:34:03.333200000 -0500
@@ -14,7 +14,6 @@
  *  See the License for the specific language governing permissions and
  *  limitations under the License.
  */
-
 package org.apache.coyote.http11.filters;
 
 import java.io.EOFException;
@@ -22,13 +21,14 @@
 
 import org.apache.tomcat.util.buf.ByteChunk;
 import org.apache.tomcat.util.buf.HexUtils;
-import org.apache.tomcat.util.buf.MessageBytes;
-import org.apache.tomcat.util.http.MimeHeaders;
+
 import org.apache.coyote.InputBuffer;
 import org.apache.coyote.Request;
 import org.apache.coyote.http11.Constants;
 import org.apache.coyote.http11.InputFilter;
-
+import org.apache.tomcat.util.buf.MessageBytes;
+import org.apache.tomcat.util.http.MimeHeaders;
+import org.apache.tomcat.util.res.StringManager;
 
 /**
  * Chunked input filter. Parses chunked data according to
@@ -39,9 +39,11 @@
  */
 public class ChunkedInputFilter implements InputFilter {
 
+    private static final StringManager sm = StringManager.getManager(
+            ChunkedInputFilter.class.getPackage().getName());
 
-    // -------------------------------------------------------------- Constants
 
+    // -------------------------------------------------------------- Constants
 
     protected static final String ENCODING_NAME = "chunked";
     protected static final ByteChunk ENCODING = new ByteChunk();
@@ -49,7 +51,6 @@
 
     // ----------------------------------------------------- Static Initializer
 
-
     static {
         ENCODING.setBytes(ENCODING_NAME.getBytes(), 0, ENCODING_NAME.length());
     }
@@ -57,7 +58,6 @@
 
     // ----------------------------------------------------- Instance Variables
 
-
     /**
      * Next buffer in the pipeline.
      */
@@ -93,39 +93,52 @@
      */
     protected ByteChunk readChunk = new ByteChunk();
 
-    /**
-     * Flag set to true if the next call to doRead must parse a 
-     * CRLF pair before doing anything else
-     */
-    protected boolean needCRLFParse = false;
 
     /**
-     * Size of extensions processed for a request
+     * Flag set to true when the end chunk has been read.
      */
-    private long extensionSize;
+    protected boolean endChunk = false;
+
 
     /**
-     * Flag set to true when the end chunk has been read.
+     * Byte chunk used to store trailing headers.
      */
-    protected boolean endChunk = false;
+    protected ByteChunk trailingHeaders;
 
-    private ByteChunk trailingHeaders;
     {
         trailingHeaders = new ByteChunk();
         if (org.apache.coyote.Constants.MAX_TRAILER_SIZE > 0) {
-            trailingHeaders.setLimit(
-                org.apache.coyote.Constants.MAX_TRAILER_SIZE);
+            trailingHeaders.setLimit(org.apache.coyote.Constants.MAX_TRAILER_SIZE);
         }
     }
 
-    private Request request = null;
 
-    // ------------------------------------------------------------- Properties
+    /**
+     * Size of extensions processed for this request.
+     */
+    private long extensionSize;
+    
+    
+    /**
+     * Flag that indicates if an error has occurred.
+     */
+    private boolean error;
+
+    /**
+     * Flag set to true if the next call to doRead() must parse a CRLF pair
+     * before doing anything else.
+     */
+    protected boolean needCRLFParse = false;
+
+
+    /**
+     * Request being parsed.
+     */
+    private Request request;
 
 
     // ---------------------------------------------------- InputBuffer Methods
 
-
     /**
      * Read bytes.
      * 
@@ -135,21 +148,21 @@
      * whichever is greater. If the filter does not do request body length
      * control, the returned value should be -1.
      */
-    public int doRead(ByteChunk chunk, Request req)
-        throws IOException {
-     
-        //this.request = req;
-        if (endChunk)
+    public int doRead(ByteChunk chunk, Request req) throws IOException {
+        if (endChunk) {
             return -1;
+        }
+
+        checkError();
 
         if(needCRLFParse) {
             needCRLFParse = false;
-            parseCRLF();
+            parseCRLF(false);
         }
 
         if (remaining <= 0) {
             if (!parseChunkHeader()) {
-                throw new IOException("Invalid chunk header");
+                throwIOException(sm.getString("chunkedInputFilter.invalidHeader"));
             }
             if (endChunk) {
                 parseEndChunk();
@@ -160,7 +173,9 @@
         int result = 0;
 
         if (pos >= lastValid) {
-            readBytes();
+            if (readBytes() < 0) {
+                throwIOException(sm.getString("chunkedInputFilter.eos"));
+            }
         }
 
         if (remaining > (lastValid - pos)) {
@@ -175,42 +190,38 @@
             remaining = 0;
             //we need a CRLF
             if ((pos+1) >= lastValid) {   
+                //if we call parseCRLF we overrun the buffer here
                 //so we defer it to the next call BZ 11117
                 needCRLFParse = true;
             } else {
-                parseCRLF(); //parse the CRLF immediately
+                parseCRLF(false); //parse the CRLF immediately
             }
         }
 
         return result;
-
     }
 
 
     // ---------------------------------------------------- InputFilter Methods
 
-
     /**
      * Read the content length from the request.
      */
     public void setRequest(Request request) {
-         this.request = request;
+        this.request = request;
     }
 
 
     /**
      * End the current request.
      */
-    public long end()
-        throws IOException {
-
+    public long end() throws IOException {
         // Consume extra bytes : parse the stream until the end chunk is found
         while (doRead(readChunk, null) >= 0) {
         }
 
         // Return the number of extra bytes which were consumed
-        return (lastValid - pos);
-
+        return lastValid - pos;
     }
 
 
@@ -218,7 +229,7 @@
      * Amount of bytes still available in a buffer.
      */
     public int available() {
-        return (lastValid - pos);
+        return lastValid - pos;
     }
     
 
@@ -241,12 +252,10 @@
         needCRLFParse = false;
         trailingHeaders.recycle();
         if (org.apache.coyote.Constants.MAX_TRAILER_SIZE > 0) {
-            trailingHeaders.setLimit(
-                org.apache.coyote.Constants.MAX_TRAILER_SIZE);
+            trailingHeaders.setLimit(org.apache.coyote.Constants.MAX_TRAILER_SIZE);
         }
         extensionSize = 0;
-        request = null;
-
+        error = false;
     }
 
 
@@ -261,12 +270,10 @@
 
     // ------------------------------------------------------ Protected Methods
 
-
     /**
      * Read bytes from the previous buffer.
      */
-    protected int readBytes()
-        throws IOException {
+    protected int readBytes() throws IOException {
 
         int nRead = buffer.doRead(readChunk, null);
         pos = readChunk.getStart();
@@ -274,7 +281,6 @@
         buf = readChunk.getBytes();
 
         return nRead;
-
     }
 
 
@@ -287,8 +293,7 @@
      * we should not parse F23IAMGONNAMESSTHISUP34CRLF as a valid header
      * according to spec
      */
-    protected boolean parseChunkHeader()
-        throws IOException {
+    protected boolean parseChunkHeader() throws IOException {
 
         int result = 0;
         boolean eol = false;
@@ -306,213 +311,225 @@
                 parseCRLF(false);
                 eol = true;
             } else if (buf[pos] == Constants.SEMI_COLON && !extension) {
-             // First semi-colon marks the start of the extension. Further
-             // semi-colons may appear to separate multiple chunk-extensions.
-             // These need to be processed as part of parsing the extensions.
+                // First semi-colon marks the start of the extension. Further
+                // semi-colons may appear to separate multiple chunk-extensions.
+                // These need to be processed as part of parsing the extensions.
                 extension = true;
                 extensionSize++;
             } else if (!extension) { 
-             //don't read data after the trailer
-		int charValue  = HexUtils.getDec(buf[pos]);
-		if (charValue != -1 && readDigit < 8)
-        {
+                //don't read data after the trailer
+                int charValue = HexUtils.getDec(buf[pos]);
+                if (charValue != -1 && readDigit < 8) {
                     readDigit++;
-                    result = (result <<4 ) | charValue;
+                    result = (result << 4) | charValue;
                 } else {
                     //we shouldn't allow invalid, non hex characters
                     //in the chunked header
                     return false;
                 }
             } else {
-                // Extension parsing
+                // Extension 'parsing'
                 // Note that the chunk-extension is neither parsed nor
                 // validated. Currently it is simply ignored.
                 extensionSize++;
                 if (org.apache.coyote.Constants.MAX_EXTENSION_SIZE > -1 &&
-                    extensionSize > org.apache.coyote.Constants.MAX_EXTENSION_SIZE)
-                { 
-                    throw new IOException("maxExtensionSize exceeded");
+                        extensionSize > org.apache.coyote.Constants.MAX_EXTENSION_SIZE) {
+                    throwIOException(sm.getString("chunkedInputFilter.maxExtension"));
                 }
             }
+
+            // Parsing the CRLF increments pos
             if (!eol) {
                 pos++;
             }
-
         }
 
-        if (readDigit == 0 && result < 0)
+        if (readDigit == 0 || result < 0) {
             return false;
+        }
 
-        if (result == 0)
+        if (result == 0) {
             endChunk = true;
+        }
 
         remaining = result;
-        if (remaining < 0)
+        if (remaining < 0) {
             return false;
+        }
 
         return true;
-
     }
 
 
     /**
      * Parse CRLF at end of chunk.
+     * @deprecated  Use {@link #parseCRLF(boolean)}
      */
-    protected boolean parseCRLF()
-        throws IOException {
-
+    @Deprecated
+    protected boolean parseCRLF() throws IOException {
         parseCRLF(false);
         return true;
     }
 
-    protected void parseCRLF(boolean tolerant)
-        throws IOException
-    {
+    /**
+     * Parse CRLF at end of chunk.
+     *
+     * @param   tolerant    Should tolerant parsing (LF and CRLF) be used? This
+     *                      is recommended (RFC2616, section 19.3) for message
+     *                      headers.
+     */
+    protected void parseCRLF(boolean tolerant) throws IOException {
 
         boolean eol = false;
         boolean crfound = false;
 
         while (!eol) {
-
             if (pos >= lastValid) {
-                if (readBytes() <= 0)
-                    throw new IOException("Invalid CRLF");
+                if (readBytes() <= 0) {
+                    throwIOException(sm.getString("chunkedInputFilter.invalidCrlfNoData"));
+                }
             }
 
             if (buf[pos] == Constants.CR) {
-                if (crfound) throw new IOException("Invalid CRLF, two CR characters encountered.");
+                if (crfound) {
+                    throwIOException(sm.getString("chunkedInputFilter.invalidCrlfCRCR"));
+                }
                 crfound = true;
             } else if (buf[pos] == Constants.LF) {
-                if (!crfound && !tolerant) {
-                    throw new IOException(
-                            "Invalid CRLF, no CR character encountered.");
+                if (!tolerant && !crfound) {
+                    throwIOException(sm.getString("chunkedInputFilter.invalidCrlfNoCR"));
                 }
                 eol = true;
             } else {
-                throw new IOException("Invalid CRLF");
+                throwIOException(sm.getString("chunkedInputFilter.invalidCrlf"));
             }
 
             pos++;
-
         }
-
     }
 
 
     /**
      * Parse end chunk data.
-     * 
      */
-    protected boolean parseEndChunk()
-        throws IOException {
+    protected boolean parseEndChunk() throws IOException {
         // Handle optional trailer headers
         while (parseHeader()) {
             // Loop until we run out of headers
         }
-
         return true;
     }
 
+    
+    private boolean parseHeader() throws IOException {
 
-    private boolean parseHeader() 
-        throws IOException {
-        
         MimeHeaders headers = request.getMimeHeaders();
+
         byte chr = 0;
 
         // Read new bytes if needed
         if (pos >= lastValid) {
-            if (readBytes() > 0)
-                throw new EOFException(
-                    "Unexpected end of stream while reading trailer headers for chunked request");
+            if (readBytes() <0) {
+               throwEOFException(sm.getString("chunkedInputFilter.eosTrailer"));
+            }
         }
-
+    
         chr = buf[pos];
 
-        //CRLF terminates the request
-        if (chr == Constants.CR || chr == Constants.LF)
-        {
+        // CRLF terminates the request
+        if (chr == Constants.CR || chr == Constants.LF) {
             parseCRLF(false);
             return false;
         }
+    
         // Mark the current buffer position
         int start = trailingHeaders.getEnd();
-
-
-        // 
+    
+        //
         // Reading the header name
         // Header name is always US-ASCII
         //
+    
         boolean colon = false;
         while (!colon) {
-            // Read bytes if needed
+    
+            // Read new bytes if needed
             if (pos >= lastValid) {
-                if (readBytes() < 0)
-                    throw new EOFException(
-                        "Unexpected end of stream while reading trailer " +
-                       " headers for chunked request");
+                if (readBytes() <0) {
+                    throwEOFException(sm.getString("chunkedInputFilter.eosTrailer"));
+                }
             }
+    
             chr = buf[pos];
-
             if ((chr >= Constants.A) && (chr <= Constants.Z)) {
                 chr = (byte) (chr - Constants.LC_OFFSET);
             }
+
             if (chr == Constants.COLON) {
                 colon = true;
             } else {
                 trailingHeaders.append(chr);
             }
+    
             pos++;
+    
         }
-        MessageBytes headerValue = headers.addValue(
-                trailingHeaders.getBytes(),
+        MessageBytes headerValue = headers.addValue(trailingHeaders.getBytes(),
                 start, trailingHeaders.getEnd() - start);
+    
         // Mark the current buffer position
         start = trailingHeaders.getEnd();
-        // Reading the header value (which can be spanned over
-        // multiple lines)
+
+        //
+        // Reading the header value (which can be spanned over multiple lines)
+        //
+    
         boolean eol = false;
         boolean validLine = true;
         int lastSignificantChar = 0;
-
+    
         while (validLine) {
+    
             boolean space = true;
+    
             // Skipping spaces
             while (space) {
+    
                 // Read new bytes if needed
                 if (pos >= lastValid) {
-                    if (readBytes() < 0)
-                        throw new EOFException(
-                            "Unexpected end of stream while reading " +
-                            "trailer headers for chunked request");
+                    if (readBytes() <0) {
+                        throwEOFException(sm.getString("chunkedInputFilter.eosTrailer"));
+                    }
                 }
+    
                 chr = buf[pos];
-                if (( chr == Constants.SP) || (chr == Constants.HT)) {
+                if ((chr == Constants.SP) || (chr == Constants.HT)) {
                     pos++;
-                    // if we swallow whitespace, make sure it counts toward
-                    // the limit placed on trailing header size (if there
-                    // is one)
+                    // If we swallow whitespace, make sure it counts towards the
+                    // limit placed on trailing header size (if there is one)
                     if (trailingHeaders.getLimit() != -1) {
-                        int newlimit = trailingHeaders.getLimit() - 1;
+                        int newlimit = trailingHeaders.getLimit() -1;
                         if (trailingHeaders.getEnd() > newlimit) {
-                            throw new IOException("Exceeded maxTrailerSize");
+                            throwIOException(sm.getString("chunkedInputFilter.maxTrailer"));
                         }
                         trailingHeaders.setLimit(newlimit);
                     }
                 } else {
                     space = false;
                 }
+    
             }
-
+    
             // Reading bytes until the end of the line
             while (!eol) {
+    
                 // Read new bytes if needed
                 if (pos >= lastValid) {
-                    if (readBytes() < 0)
-                        throw new EOFException(
-                            "Unexpected end of stream while reading trailer " +
-                            "headers for chunked request");
+                    if (readBytes() <0) {
+                        throwEOFException(sm.getString("chunkedInputFilter.eosTrailer"));
+                    }
                 }
+    
                 chr = buf[pos];
                 if (chr == Constants.CR || chr == Constants.LF) {
                     parseCRLF(true);
@@ -523,42 +540,57 @@
                     trailingHeaders.append(chr);
                     lastSignificantChar = trailingHeaders.getEnd();
                 }
-
+    
                 if (!eol) {
                     pos++;
                 }
             }
-
+    
             // Checking the first character of the new line. If the character
-            // is a LWS, the it's a multiline header
-            //
+            // is a LWS, then it's a multiline header
+    
             // Read new bytes if needed
             if (pos >= lastValid) {
-                if (readBytes() < 0)
-                    throw new EOFException(
-                        "Unexpected end of stream while reading trailer " +
-                        "headers for chunked request");
+                if (readBytes() <0) {
+                    throwEOFException(sm.getString("chunkedInputFilter.eosTrailer"));
+                }
             }
+    
             chr = buf[pos];
             if ((chr != Constants.SP) && (chr != Constants.HT)) {
                 validLine = false;
             } else {
                 eol = false;
                 // Copying one extra space in the buffer (since there must
-                // be at lease one space inserted between the lines)
+                // be at least one space inserted between the lines)
                 trailingHeaders.append(chr);
             }
+    
         }
-
+    
         // Set the header value
         headerValue.setBytes(trailingHeaders.getBytes(), start,
                 lastSignificantChar - start);
-
+    
         return true;
     }
 
 
+    private void throwIOException(String msg) throws IOException {
+        error = true;
+        throw new IOException(msg);
+    }
 
 
+    private void throwEOFException(String msg) throws IOException {
+        error = true;
+        throw new EOFException(msg);
+    }
 
+
+    private void checkError() throws IOException {
+        if (error) {
+            throw new IOException(sm.getString("chunkedInputFilter.error"));
+        }
+    }
 }
--- webapps/docs/changelog.xml.orig	2015-02-25 14:10:34.166788000 -0500
+++ webapps/docs/changelog.xml	2015-02-25 15:01:01.799517000 -0500
@@ -43,2610 +43,6 @@
 <!-- Section names:
  General, Catalina, Coyote, Jasper, Cluster, Web applications, Other
 -->
-<section name="Tomcat 6.0.39 (markt)">
-  <subsection name="Catalina">
-    <changelog>
-      <fix>
-        <bug>55166</bug>: Fix regression that broke XML validation when running
-        on some Java 5 JVMs. (kkolinko)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Coyote">
-    <changelog>
-      <fix>
-        Make the HTTP NIO connector tolerant of whitespace in the individual
-        values used for the ciphers attribute. (markt)
-      </fix>
-      <fix>
-        Remove dependency introduced on the jsp-api.jar as part of the XML
-        validation changes introduced in 6.0.38. (markt)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Jasper">
-    <changelog>
-      <fix>
-        Correct several errors in jspxml Schema and DTD. (kkolinko)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Cluster">
-    <changelog>
-      <scode>
-        Remove an empty TestTwoPhaseCommit test from Tribes. (kkolinko)
-      </scode>
-    </changelog>
-  </subsection>
-  <subsection name="Web applications">
-    <changelog>
-      <fix>
-        Fix broken link in Jasper How-To documentation. (markt)
-      </fix>
-      <fix>
-        Align index.html and index.jsp in ROOT web application. Correct links
-        to specifications and to the Tomcat mailing lists. (kkolinko)
-      </fix>
-      <fix>
-        Remove second copy of RUNNING.txt from the full-docs distribution. Some
-        unpacking utilities can't handle multiple copies of a file with the same
-        name in a directory. (kkolinko)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Other">
-    <changelog>
-      <update>
-        Update sample Eclipse IDE project: use JUnit 4 library and prefer a
-        Java 5 JDK when several JDKs are configured. Cleanup the Ant build
-        files. (kkolinko)
-      </update>
-      <fix>
-        Correct Maven dependencies for individual JAR files. (markt)
-      </fix>
-    </changelog>
-  </subsection>
-</section>
-<section name="Tomcat 6.0.38 (markt)"  rtext="not released">
-  <subsection name="Catalina">
-    <changelog>
-      <fix>
-        Ensure that when Tomcat&apos;s anti-resource locking features are used
-        that the temporary copy of the web application and not the original is
-        removed when the web application stops. (markt/kkolinko) 
-      </fix>
-      <fix>
-        <bug>55019</bug>: Fix a potential exception when accessing JSPs while
-        running under a SecurityManager. (jfclere)
-      </fix>
-      <fix>
-        <bug>55052</bug>: Make JULI&apos;s LogManager to additionally look for
-        logging properties without prefixes if the property cannot be found with
-        a prefix. (kkolinko)
-      </fix>
-      <fix>
-        <bug>55266</bug>: Ensure that the session ID is parsed from the request
-        before any redirect as the session ID may need to be encoded as part of
-        the redirect URL. (markt)
-      </fix>
-      <fix>
-        <bug>55404</bug>: Log warnings about using security roles in web.xml as
-        warnings. (markt)
-      </fix>
-      <fix>
-        <bug>55268</bug>: Added optional --service-start-wait-time
-        command-line option to change service start wait time from default
-        of 10 seconds. (schultz)
-      </fix>
-      <fix>
-        Correctly associate the default resource bundle with the English locale
-        so that requests that specify an Accept-Language of English ahead of
-        French, Spanish or Japanese get the English messages they asked for.
-        (markt) 
-      </fix>
-      <fix>
-        Add missing JavaEE 5 XML schema definitions. (markt)
-      </fix>
-      <fix>
-        When Catalina parses TLD files, always use a namespace aware parser to
-        be consistent with how Jasper parses TLD files. The
-        <code>tldNamespaceAware</code> attribute of the Context is now ignored.
-        (markt)
-      </fix>
-      <fix>
-        As per section SRV.14.4.3 of the Servlet 2.5 specification, a namespace
-        aware, validating parser will be used when processing <code>*.tld</code>
-        and <code>web.xml</code> files if the system property
-        <code>org.apache.catalina.STRICT_SERVLET_COMPLIANCE</code> is set to
-        <code>true</code>. (markt) 
-      </fix>
-      <fix>
-        Ensure that sessions IDs are not parsed from URLs for Contexts where
-        <code>disableURLRewriting</code> is <code>true</code>. (markt)
-      </fix>
-      <add>
-        Add an option to the Context to control the blocking of XML external
-        entities when parsing XML configuration files and enable this blocking
-        by default when a security manager is used. The block is implemented via
-        a custom resolver to enable the logging of any blocked entities. (markt)
-      </add>
-      <fix>
-        <bug>56016</bug>: When loading resources for XML schema validation, take
-        account of the possibility that servlet-api.jar and jsp-api.jar may not
-        be loaded by the same class loader. Patch by Juan Carlos Estibariz.
-        (markt)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Coyote">
-    <changelog>
-      <fix>
-        <bug>52811</bug>: Fix parsing of Content-Type header in
-        <code>HttpServletResponse.setContentType()</code>. Introduces a new HTTP
-        header parser that follows RFC2616. (markt)
-      </fix>
-      <fix>
-        <bug>54691</bug>: Add configuration attribute "sslEnabledProtocols"
-        to HTTP connector and document it. (Internally this attribute has
-        been already implemented but not documented, under names "protocols"
-        and "sslProtocols". Those names of this attribute are now deprecated).
-        (schultz)
-      </fix>
-      <fix>
-        <bug>54947</bug>: Fix the HTTP NIO connector that incorrectly rejected a
-        request if the CRLF terminating the request line was split across
-        multiple packets. Patch by Konstantin Preißer. (markt)
-      </fix>
-      <fix>
-        <bug>55228</bug>: Allow web applications to set a HTTP Date header.
-        (markt)
-      </fix>
-      <fix>
-        Better adherence to RFC2616 for content-length headers. (markt)
-      </fix>
-      <fix>
-        Add support for limiting the size of chunk extensions when using chunked
-        encoding. (markt)
-      </fix>
-      <fix>
-        <bug>55749</bug>: Improve the error message when SSLEngine is disabled
-        in the AprLifecycleListener and SSL is configured for an APR/native
-        connector. (markt)
-      </fix>
-      <fix>
-        Avoid possible NPE if a content type is specified without a character set.
-        (markt)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Jasper">
-    <changelog>
-      <fix>
-        <bug>55198</bug>: Ensure attribute values in tagx files that include EL
-        and quoted XML characters are correctly quoted in the output. (markt)
-      </fix>
-      <fix>
-        <bug>55671</bug>: Consistently use the configuration option name
-        <code>genStringAsCharArray</code> rather than a mixture of
-        <code>genStrAsCharArray</code> and <code>genStringAsCharArray</code> but
-        retain support for <code>genStrAsCharArray</code> as in initialisation
-        parameter for the JSP servlet to retain backwards compatibility with
-        existing configurations. (markt)
-      </fix>
-      <fix>
-        <bug>55691</bug>: Fix <code>javax.el.ArrayELResolver</code> to correctly
-        handle the case where the base object is an array of primitives. (markt)
-      </fix>
-      <fix>
-        <bug>55973</bug>: Fix processing of XML schemas when validation is
-        enabled in Jasper. (kkolinko)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Web applications">
-    <changelog>
-      <add>
-        Add documentation for
-        <code>o.a.c.tribes.group.interceptors.TcpFailureDetector</code>.
-        (kfujino)
-      </add>
-      <add>
-        Complete the documentation for
-        <code>MessageDispatch15Interceptor</code>. (kfujino)
-      </add>
-      <add>
-        Add to cluster document a description of
-        <code>notifyLifecycleListenerOnFailure</code> and
-        <code>heartbeatBackgroundEnabled</code>. (kfujino)
-      </add>
-      <fix>
-        <bug>55746</bug>: Add documentation on the <code>allRolesMode</code> to
-        the <code>CombinedRealm</code> and <code>LockOutRealm</code>. Patch by
-        Cédric Couralet. (markt)
-      </fix>
-      <fix>
-        Fix the sample configuration of <code>StaticMembershipInterceptor</code>
-        in order to prevent warning log. uniqueId must be 16 bytes. (kfujino)
-      </fix>
-      <fix>
-        <bug>55119</bug>: Avoid CVE-2013-1571 when generating Javadoc. (markt)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Other">
-    <changelog>
-      <update>
-        Update Maven Central location used to download dependencies at build
-        time to be <code>repo.maven.apache.org</code>. (kkolinko)
-      </update>
-      <fix>
-        <bug>55663</bug>: Minor correction to the wording of the NOTICE files to
-        align them with the
-        <a href="http://www.apache.org/legal/src-headers.html#notice">requirements
-        for NOTICE files</a>. (violetagg)
-      </fix>
-      <fix>
-        Add <code>@since</code> markers to the common annotations classes and
-        fix a few specification compliance issues. (markt)
-      </fix>
-      <update>
-        Update to Eclipse JDT Compiler 4.3.1. (markt)
-      </update>
-      <update>
-        Update the Apache Jakarta JSTL implementation used by the exmaples web
-        application to 1.1.2. (markt)
-      </update>
-    </changelog>
-  </subsection>
-</section>
-<section name="Tomcat 6.0.37 (jfclere)" rtext="released 2013-05-03">
-  <subsection name="Catalina">
-    <changelog>
-      <fix>
-        <bug>52055</bug>: Ensure that filters are recycled. (markt/kkolinko)
-      </fix>
-      <fix>
-        <bug>52184</bug>: Reduce log level for invalid cookies. (markt)
-      </fix>
-      <fix>
-        <bug>53481</bug>: Added support for SSLHonorCipherOrder to allow
-        the server to impose its cipher order on the client. Based on a patch
-        provided by Marcel &#x160;ebek. (schultz)
-      </fix>
-      <fix>
-        <bug>54044</bug>: Correct bug in timestamp cache used by logging
-        (including the access log valve) that meant entries could be made with
-        an earlier timestamp than the true timestamp. (markt) 
-      </fix>
-      <fix>
-        In FormAuthenticator: If it is configured to change Session IDs,
-        do the change before displaying the login form. (kkolinko)
-      </fix>
-      <fix>
-        <bug>54054</bug>: Do not share shell environment variables between
-        multiple instances of the CGI servlet. (markt)
-      </fix>
-      <fix>
-        <bug>54087</bug>: Correctly handle (ignore) invalid If-Modified-Since
-        header rather than throwing an exception. (markt/kkolinko)
-      </fix>
-      <fix>
-        <bug>54220</bug>: Ensure the ErrorReportValve only generates an error
-        report if the error flag on the response has been set. (markt)
-      </fix>
-      <fix>
-        Fix memory leak of servlet instances when running with a
-        SecurityManager and either init() or destroy() methods fail
-        or the servlet is a SingleThreadModel one, and of filter instances
-        if their destroy() method fails with an Error. (kkolinko)
-      </fix>
-      <fix>
-        <bug>54382</bug>: Fix NPE when SSI processing is enabled and an empty
-        SSI directive is present. (markt)
-      </fix>
-      <fix>
-        <bug>54483</bug>: Correct one of the Spanish translations. Based on a
-        suggestion from adinamita. (kkolinko)
-      </fix>
-      <update>
-        <bug>54527</bug>: Synchronize conf/web.xml mime mapping with Tomcat 7.
-        (markt)
-      </update>
-    </changelog>
-  </subsection>
-  <subsection name="Coyote">
-    <changelog>
-      <fix>
-        <bug>54248</bug>: Ensure that byte order marks are swallowed when using
-        a Reader to read a request body with a BOM for those encodings that
-        require byte order marks. (markt)
-      </fix>
-      <fix>
-        <bug>54324</bug>: Allow APR connector to disable TLS compression
-        if OpenSSL supports it. (schultz)
-      </fix>
-      <fix>
-        <bug>54456</bug>: Ensure that if a client aborts a request when sending
-        a chunked request body that this is communicated correctly to the client
-        reading the request body. (markt)
-      </fix>
-      <update>
-        Update the native component of the APR/native connector to 1.1.27 and
-        make that version the recommended minimum version. (kkolinko)
-      </update>
-    </changelog>
-  </subsection>
-  <subsection name="Jasper">
-    <changelog>
-      <fix>
-        <bug>54615</bug>:  Tomcat 6 doesn't build against ecj 4.x (kkolinko)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Cluster">
-    <changelog>
-      <fix>
-        <bug>54045</bug>: Make sure getMembers() returns available member when
-        TcpFailureDetector works in static cluster. (kfujino)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Web applications">
-    <changelog>
-      <update>
-        <bug>22278</bug>: Add a commented out sample configuration of
-        <code>RemoteAddrValve</code> to <code>META-INF/context.xml</code>
-        files of the Manager and Host Manager applications. (kkolinko)
-      </update>
-      <fix>
-        <bug>54080</bug>: Clarify documentation for initial value of
-        <code>internalProxies</code> attribute of <code>RemoteIpValve</code>.
-        (schultz/kkolinko)
-      </fix>
-      <fix>
-        <bug>54198</bug>: Clarify that
-        <code>HttpServletResponse.sendError(int)</code> results in an HTML
-        response by default. (markt)
-      </fix>
-      <fix>
-        <bug>54207</bug>: Correct JNDI factory package name in Javadoc for
-        <code>org.apache.naming.java.javaURLContextFactory</code>. (markt)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Other">
-    <changelog>
-      <update>
-       Add sample Apache Commons Daemon JSVC wrapper script bin/daemon.sh that
-       can be used with /etc/init.d. (kkolinko)
-      </update>
-      <update>
-        In the build configuration: introduce property "tomcat.output" that is
-        used to specify location of the build output directory. This simplifies
-        configuration if someone wants to move the <code>output</code> directory
-        elsewhere (e.g. out of the source tree). (kkolinko)
-      </update>
-      <fix>
-        <bug>54390</bug>: Use 'java_home' on Mac OS X to auto-detect JAVA_HOME.
-        (schultz)
-      </fix>
-      <update>
-        <bug>54601</bug>: Change catalina.sh to consistently use LOGGING_MANAGER
-          variable to configure logging, instead of modifying JAVA_OPTS one.
-          (kkolinko) 
-      </update>
-      <update>
-        <bug>54890</bug>: Update to Apache Commons Daemon 1.0.15. (mturk)
-      </update>
-    </changelog>
-  </subsection>
-</section>
-<section name="Tomcat 6.0.36 (jfclere)" rtext="released 2012-10-19">
-  <subsection name="Catalina">
-    <changelog>
-      <update>
-        <bug>48692</bug>: Provide option to parse
-        <code>application/x-www-form-urlencoded</code> PUT requests. (schultz)
-      </update>
-      <add>
-        <bug>50306</bug>: New StuckThreadDetectionValve to detect requests that
-        take a long time to process, which might indicate that their processing
-        threads are stuck. Based on a patch provided by TomLu. (kkolinko)
-      </add>
-      <fix>
-        <bug>50570</bug>: Enable FIPS mode to be set in AprLifecycleListener.
-        Based upon a patch from Chris Beckey. Note that this mode requires
-        tomcat-native 1.1.23 or later linked to a FIPS-capable OpenSSL library,
-        which one has to build by themselves. (schultz/kkolinko)
-      </fix>
-      <fix>
-        Improve synchronization and error handling in AprLifecycleListener.
-        Do not allow to change SSL options if SSL has already been initialized.
-        (schultz/kkolinko)
-      </fix>
-      <fix>
-        <bug>52225</bug>: Fix ClassCastException when adding an alias for an
-        existing host via JMX. (kkolinko)
-      </fix>
-      <fix>
-        <bug>52293</bug>: Correctly handle the case when
-        <code>antiResourceLocking</code> is enabled at the Context level when
-        <code>unpackWARs</code> is disabled at the Host level. Correctly
-        handle multi-level contexts when <code>antiResourceLocking</code>
-        is enabled. Patch by Justin Miller. (kkolinko)
-      </fix>
-      <fix>
-        Do not throw IllegalArgumentException from parseParameters() call
-        when chunked POST request is too large, but treat it like an IO error.
-        The <code>FailedRequestFilter</code> filter can be used to detect this
-        condition. (kkolinko)
-      </fix>
-      <fix>
-        <bug>52384</bug>: Do not fail with parameter parsing when debug logging
-        is enabled. (kkolinko)
-      </fix>
-      <fix>
-        Do not flag extra '&amp;' characters in parameters as parse errors.
-        (kkolinko)
-      </fix>
-      <fix>
-        <bug>52488</bug>: Correct typos: exipre -> expire. Based on a patch by
-        prockter. (markt)
-      </fix>
-      <fix>
-        Reduce log level for the message about hitting
-        <code>maxParameterCount</code> limit from WARN to INFO.
-        Fix limit comparison to allow exactly <code>maxParameterCount</code>
-        parameters, as documentation says, instead of
-        <code>(maxParameterCount-1)</code>. (kkolinko)
-      </fix>
-      <fix>
-        Slightly improve performance of UDecoder.convert(). Align
-        <code>%2f</code> handling between implementations. (kkolinko)
-      </fix>
-      <add>
-        Add <code>denyStatus</code> attribute to <code>RequestFilterValve</code>
-        (<code>RemoteAddrValve</code>, <code>RemoteHostValve</code> valves).
-        It allows to use different HTTP response code when rejecting denied
-        request. E.g. 404 instead of 403. (kkolinko)
-      </add>
-      <add>
-        Add <code>SetCharacterEncodingFilter</code> (similar to the one
-        contained in the examples web application) to the
-        <code>org.apache.catalina.filters</code> package so that it is
-        available for all web applications. (kkolinko)
-      </add>
-      <add>
-        <bug>52500</bug>: Added configurable mechanism to retrieve user names
-        from X509 client certificates. Based on a patch provided by
-        Michael Furman. (schultz/kkolinko)
-      </add>
-      <fix>
-        <bug>52719</bug>: Fix a theoretical resource leak in the JAR validation
-        that checks for non-permitted classes in web application JARs. (markt)
-      </fix>
-      <fix>
-        <bug>52830</bug>: Correct JNDI lookups when using
-        <code>javax.naming.Name</code> to identify the resource rather than a
-        <code>java.lang.String</code>. (markt)
-      </fix>
-      <add>
-        <bug>52850</bug>: Extend memory leak prevention and detection code to
-        work with IBM as well as Oracle JVMs. Based on a patch provided by
-        Rohit Kelapure. (kkolinko)
-      </add>
-      <add>
-        <bug>52996</bug>: In <code>StandardThreadExecutor</code>:
-        Add the ability to configure a job queue size
-        (<code>maxQueueSize</code> attribute).
-        Add a variant of execute method that allows to specify a timeout for
-        how long we want to try to add something to the queue.
-        Based on a patch by R&#252;diger Pl&#252;m. (kkolinko)
-      </add>
-      <fix>
-        <bug>53047</bug>: If a JDBCRealm or DataSourceRealm is configured for
-        an all roles mode that only requires authorization (and no roles) and no
-        role table or column is defined, don't populate the Principal's roles.
-        (markt/kkolinko)
-      </fix>
-      <fix>
-        <bug>53050</bug>: Fix handling of entropy value when initializing
-        session id generator in session manager. Based on proposal by
-        Andras Rozsa. (kkolinko)
-      </fix>
-      <fix>
-        <bug>53056</bug>: Add APR version number to tcnative version INFO log
-        message. (schultz)
-      </fix>
-      <fix>
-        <bug>53057</bug>: Add OpenSSL version number INFO log message when
-        initializing. (schultz)
-      </fix>
-      <fix>
-        <bug>53071</bug>: Use the message from the Throwable for the error
-        report generated by the <code>ErrorReportValve</code> if none was
-        specified via <code>sendError()</code>. Use the standard text for HTTP
-        error codes. (markt/rjung)
-      </fix>
-      <update>
-        <bug>53230</bug>: Change session managers to throw
-        TooManyActiveSessionsException instead of IllegalStateException
-        when the maximum number of sessions has been exceeded and a new
-        session will not be created. (schultz/kkolinko)
-      </update>
-      <fix>
-        <bug>53267</bug>: Ensure that using the GC Daemon Protection feature of
-        the <code>JreMemoryLeakPreventionListener</code> does not trigger a
-        full GC every hour. (markt/kkolinko)
-      </fix>
-      <fix>
-        <bug>53531</bug>: Fix ExpandWar.expand to check the return value of
-        File.mkdir and File.mkdirs. (schultz)
-      </fix>
-      <fix>
-        Make the CSRF nonce cache in <code>CsrfPreventionFilter</code>
-        serializable so that it can be replicated across a cluster and/or
-        persisted across Tomcat restarts. (markt)
-      </fix>
-      <fix>
-        <bug>53584</bug>: Ignore path parameters when comparing URIs for FORM
-        authentication. This prevents users being prompted twice for passwords
-        when logging in when session IDs are being encoded as path parameters.
-        (markt)
-      </fix>
-      <fix>
-        Various improvements to the DIGEST authenticator including
-        <bug>52954</bug>, the disabling caching of an authenticated user in the
-        session by default, tracking server rather than client nonces and better
-        handling of stale nonce values. (markt)
-      </fix>
-      <fix>
-        CVE-2012-3546: Fix bypass of security constraint checks with FORM
-        authentication. Remove unneeded processing in <code>RealmBase</code>.
-        (kkolinko)
-      </fix>
-      <fix>
-        <bug>53800</bug>: <code>FileDirContext.list()</code> did not provide
-        correct paths for subdirectories. Patch provided by Kevin Wooten.
-        (kkolinko)
-      </fix>
-      <fix>
-        <bug>53830</bug>: Better handling of <code>Manager.randomFile</code>
-        default value on Windows. (kkolinko)
-      </fix>
-      <fix>
-        CVE-2012-4431: Fix bypass of <code>CsrfPreventionFilter</code> when
-        there is no session. Improve session management in the filter.
-        (kkolinko)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Coyote">
-    <changelog>
-      <fix>
-        <bug>42181</bug>: Better handling of edge conditions in chunk header
-        processing. (kkolinko)
-      </fix>
-      <update>
-        <bug>51477</bug>: Support all SSL protocol combinations in the APR/native
-        connector. This only works when using the native library version 1.1.21
-        or later. (rjung)
-      </update>
-      <fix>
-        <bug>52055</bug> (comment 14): Correctly reset
-        <code>ChunkedInputFilter.needCRLFParse</code> flag when the filter
-        is recycled. (kkolinko)
-      </fix>
-      <fix>
-        <bug>52606</bug>: Ensure replayed POST bodies are available when using
-        AJP. (markt)
-      </fix>
-      <fix>
-        <bug>52858</bug>, CVE-2012-4534: Fix high CPU load with SSL, NIO and
-        sendfile when client breaks the connection before reading all the
-        requested data.
-        (fhanik/kkolinko)
-      </fix>
-      <fix>
-        <bug>53119</bug>: Prevent buffer overflow errors being reported when a
-        client disconnects before the response has been fully written from an
-        AJP connection using the APR/native connector. (kkolinko)
-      </fix>
-      <fix>
-        Improve <code>InternalNioInputBuffer.parseHeaders()</code>. (kkolinko)
-      </fix>
-      <add>
-        Implement <code>maxHeaderCount</code> attribute on Connector.
-        It is equivalent of LimitRequestFields directive of
-        <a href="http://httpd.apache.org/">Apache HTTPD</a>.
-        Default value is 100. (kkolinko)
-      </add>
-      <fix>
-        In JkCoyoteHandler connector for AJP/1.3 protocol
-        (in <code>JkMain.setProperty()</code>):
-        Fix setting of properties when connector has already started for
-        properties that have aliases. E.g. it now allows to change
-        <code>maxHeaderCount</code> attribute on Connector MBean via JMX.
-        (kkolinko)
-      </fix>
-      <fix>
-        <bug>53725</bug>: Fix possible corruption of GZIP'd output. (kkolinko)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Jasper">
-    <changelog>
-      <fix>
-        <bug>48097</bug> (comment 7), <bug>53366</bug> (comment 1):
-        If JSP page unexpectedly fails to initialize PageContext instance,
-        write exception to the logs instead of silent swallowing. (kkolinko)
-      </fix>
-      <fix>
-        <bug>52335</bug>: Only handle <code>&lt;\%</code> and not
-        <code>\%</code> as escaped in template text. (markt)
-      </fix>
-      <fix>
-        <bug>52666</bug>: Correct coercion order in EL when processing the
-        equality and inequality operators. (markt)
-      </fix>
-      <fix>
-        <bug>53001</bug>: Revert the fix for <bug>46915</bug> since the use case
-        described in the bug is invalid since it breaks the EL specification.
-        (markt)
-      </fix>
-      <fix>
-        <bug>53032</bug>: Modify <code>JspC</code> so it extends
-        <code>org.apache.tools.ant.Task</code> enabling it to work with features
-        such as namespaces within build.xml files. (markt)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Cluster">
-    <changelog>
-      <fix>
-        Replicate principal in ClusterSingleSignOn. (kfujino)
-      </fix>
-      <fix>
-        <bug>53513</bug>: Fix race condition between the processing of session
-        sync message and transfer complete message. (kfujino)
-      </fix>
-      <fix>
-        <bug>53606</bug>: Fix potential NPE in <code>TcpPingInterceptor</code>.
-        Based on a patch by F. Arnoud. (markt)
-      </fix>
-      <fix>
-        <bug>53607</bug>: To avoid NPE, set TCP PING data to ChannelMessage.
-        Patch provided by F.Arnoud (kfujino)
-      </fix>
-      <fix>
-        Fix a behavior of TcpPingInterceptor#useThread.
-        Do not start a ping thread when useThread is set to false. (kfujino)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Web applications">
-    <changelog>
-      <fix>
-        <bug>52243</bug>: Improve windows service documentation to clarify how
-        to include <code>#</code> and/or <code>;</code> in the value of an
-        environment variable that is passed to the service. (markt)
-      </fix>
-      <fix>
-        <bug>52515</bug>: Make it clear in the Realm how-to in the documentation
-        web application that digested password storage when using DIGEST
-        authentication requires that MD5 digests are used. (markt)
-      </fix>
-      <fix>
-        <bug>52641</bug>: Remove mentioning of ldap.jar from docs.
-        Patch provided by Felix Schumacher. (rjung)
-      </fix>
-      <fix>
-        Remove obsolete bug warning from windows service
-        documentation page. (rjung)
-      </fix>
-      <fix>
-        <bug>52983</bug>: Remove unnecessary code that makes switching to
-        other authentication methods difficult. (markt)
-      </fix>
-      <fix>
-        <bug>53158</bug>: Fix documented defaults for DBCP.
-        Patch provided by ph.dezanneau at gmail.com. (rjung)
-      </fix>
-      <update>
-        Update JavaSE documentation links to point to the current
-        docs.oracle.com site, instead of obsolete ones (download.oracle.com,
-        java.sun.com). (kkolinko)
-      </update>
-      <update>
-        <bug>53289</bug>: Clarify <code>ResourceLink</code> example that
-        uses DataSource.getConnection(username, password) method. Not all
-        data source implementations support it. (kkolinko)
-      </update>
-      <fix>
-        Prevent the custom error pages for the Manager and Host Manager
-        applications from being accessed directly. Configure custom
-        pages for error codes 401 and 403 in Host Manager application.
-        (markt/kkolinko)
-      </fix>
-      <fix>
-        Correct documentation for <code>enableLookups</code> attribute
-        of a Connector. By default DNS lookups are disabled. (kkolinko)
-      </fix>
-      <fix>
-        Fix several HTML markup errors in servlets of examples web application.
-        (kkolinko)
-      </fix>
-      <update>
-        Change the index page of ROOT webapp to mention "manager-gui" role
-        instead of "manager" one. (kkolinko)
-      </update>
-      <fix>
-        <bug>53473</bug>: Correct the allowed values for the SSI option
-        <code>isVirtualWebappRelative</code> which are <code>true</code> or
-        <code>false</code>. (markt)
-      </fix>
-      <fix>
-        <bug>53664</bug>: Minor JNDI Howto document enhancement concerning mail
-        properties. Patch provided by Mark Eggers. (schultz)
-      </fix>
-      <fix>
-        <bug>53601</bug>: Clarify that to build Apache Tomcat 6 from sources
-        a Java 5 JDK is recommended. (kkolinko)
-      </fix>
-      <fix>
-        <bug>53793</bug>: Change links on the list of applications in the
-        Manager to point to <code>/appname/</code> instead of
-        <code>/appname</code>. (kkolinko)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Other">
-    <changelog>
-      <fix>
-        <bug>49402</bug>, <bug>52124</bug>: Fix Maven publishing script:
-        make sure it finds tomcat-juli.jar and use later version of
-        wagon-ssh. (jfclere)
-      </fix>
-      <fix>
-        Update Apache Commons Daemon to 1.0.10. It resolves <bug>52548</bug>
-        which meant that services created with service.bat did not set the
-        <code>catalina.home</code> and <code>catalina.base</code> system
-        properties. (markt, kkolinko)
-      </fix>
-      <update>
-        Update Apache Commons Pool to 1.5.7. (kkolinko)
-      </update>
-      <update>
-        <bug>52579</bug>: Add a note about Sun's Charset.decode() bug to the
-        RELEASE-NOTES file. (kkolinko)
-      </update>
-      <update>
-        <bug>52805</bug>: Update to Eclipse JDT Compiler 3.7.2. (kkolinko)
-      </update>
-      <update>
-        Update the native component of the APR/native connectors to 1.1.23
-        and take advantage of the simplified distribution. (kkolinko) 
-      </update>
-      <fix>
-        When building a Windows installer do not copy whole "res" folder to
-        output/dist, but only the files that we need. Apply fixcrlf filter
-        only after the files are copied, so that <code>INSTALLLICENSE</code>
-        file had correct line ends. (kkolinko)
-      </fix>
-      <update>
-        Remove <code>res/License.rtf</code>. The file that is actually shown
-        by the Windows installer is <code>res/INSTALLLICENSE</code>.
-        (kkolinko)
-      </update>
-      <update>
-        Improve <code>RUNNING.txt</code>. (kkolinko)
-      </update>
-      <update>
-        Align the script that deploys Maven jars for Tomcat
-        (<code>res/maven/mvn-pub.xml</code>) with the Tomcat 7 version,
-        making full use of Nexus. (markt)
-      </update>
-      <add>
-        <bug>53034</bug>: Add <code>project.url</code> and
-        <code>project.licenses</code> sections to the POMs for the Maven
-        artifacts. (kkolinko)
-      </add>
-      <fix>
-        <bug>53454</bug>: Return correct content-length header for HEAD requests
-        when content length is greater than 2GB. (markt)
-      </fix>
-    </changelog>
-  </subsection>
-</section>
-<section name="Tomcat 6.0.35 (jfclere)" rtext="released 2011-12-05">
-  <subsection name="Catalina">
-    <changelog>
-      <fix>
-        Fix regression in decoding of parameters that contain spaces.
-        Patch by Willem Fibbe. (kkolinko)
-      </fix>
-    </changelog>
-  </subsection>
-</section>
-<section name="Tomcat 6.0.34 (jfclere)" rtext="not released">
-  <subsection name="Catalina">
-    <changelog>
-      <fix>
-        <bug>51550</bug>: Display an error page rather than an empty response
-        for an IllegalStateException caused by too many active sessions. (markt)
-      </fix>
-      <add>
-        <bug>51640</bug>: Improve the memory leak prevention for leaks
-        triggered by java.sql.DriverManager. (markt/kkolinko)
-      </add>
-      <fix>
-        <bug>51688</bug>: JreMemoryLeakPreventionListener now protects against
-        AWT thread creation. (schultz)
-      </fix>
-      <fix>
-        <bug>51758</bug>: The digester (used for processing XML files) used the
-        logger name <code>org.apache.commons.digester.Digester</code> rather
-        than the expected <code>org.apache.tomcat.util.digester.Digester</code>.
-        The digester has been changed to use the expected logger name.
-        (kkolinko)
-      </fix>
-      <add>
-        <bug>51862</bug>: Added a <code>classesToInitialize</code> attribute to 
-        <code>JreMemoryLeakPreventionListener</code> to allow pre-loading of configurable
-        classes to avoid some classloader leaks. (slaurent)
-      </add>
-      <fix>
-        <bug>51872</bug>: Ensure that the access log always uses the correct
-        value for the remote IP address associated with the request and that
-        requests with multiple errors do not result in multiple entries in
-        the access log. (markt)
-      </fix>
-      <add>
-        Allow to overwrite the check for distributability
-        of session attributes by session implementations. (rjung)
-      </add>
-      <add>
-        Provide the log format "OneLineFormatter" for JULI that provides the same
-        information as the default plus thread name but on a single line.
-        (markt/rjung)
-      </add>
-      <fix>
-        Ensure the the memory leak protection for the HttpClient keep-alive
-        always operates even if the thread has already stopped. (markt)
-      </fix>
-      <fix>
-        <bug>51940</bug>: Do not limit saving of request bodies during FORM
-        authentication to POST requests since any HTTP method may include a
-        request body. Based on a patch by Nicholas Sushkin. (kkolinko)
-      </fix>
-      <fix>
-        <bug>52091</bug>: Address performance issues related to lock contention
-        in StandardWrapper. Based on patch provided by Taiki Sugawara.
-        (kkolinko)
-      </fix>
-      <update>
-        In GenericPrincipal, SerializablePrincipal: Do not sort lists of roles
-        that have only one element. (kkolinko)
-      </update>
-      <add>
-        Make configuration issue for CsrfPreventionFilter result in the
-        failure of the filter rather than just a warning message. (kkolinko)
-      </add>
-      <fix>
-        Ensure changes to the configuration of RemoteAddrValve and
-        RemoteHostValve via JMX are thread-safe. (kkolinko)
-      </fix>
-      <add>
-        Make configuration issue for RemoteAddrValve and
-        RemoteHostValve result in the failure of the valve rather than
-        just a warning message. (kkolinko)
-      </add>
-      <update>
-        In <code>RequestFilterValve</code> (<code>RemoteAddrValve</code>,
-        <code>RemoteHostValve</code>): refactor value matching logic into
-        separate method and expose this new method <code>isAllowed</code>
-        through JMX. (kkolinko)
-      </update>
-      <add>
-        Improve performance of parameter processing for GET and POST requests.
-        Also add an option to limit the maximum number of parameters processed
-        per request. This defaults to 10000. Excessive parameters are ignored.
-        Note that <code>FailedRequestFilter</code> can be used to reject the
-        request if some parameters were ignored. (markt/kkolinko)
-      </add>
-      <add>
-        New filter <code>FailedRequestFilter</code> that will reject a request
-        if there were errors during HTTP parameter parsing. (kkolinko)
-      </add>
-    </changelog>
-  </subsection>
-  <subsection name="Coyote">
-    <changelog>
-      <fix>
-        <bug>50394</bug>: Return -1 from read operation instead of throwing an
-        exception when encountering an EOF with the HTTP APR connector.
-        (kkolinko)
-      </fix>
-      <fix>
-        <bug>51698</bug>: Fix CVE-2011-3190. Prevent AJP message injection.
-        (markt)
-      </fix>
-      <fix>
-        Detect incomplete AJP messages and reject the associated request if one
-        is found. (markt)
-      </fix>
-      <fix>
-        <bug>51794</bug>: Fix race condition in NioEndpoint selector. Patch
-        provided by dlord. (fhanik)
-      </fix>
-      <fix>
-        <bug>51905</bug>: Fix infinite loop in AprEndpoint shutdown if
-        acceptor unlock fails. Reduce timeout before forcefully closing
-        the socket from 30s to 10s. (kkolinko)
-      </fix>
-      <fix>
-        <bug>52121</bug>: Fix possible output corruption when compression is
-        enabled for a connector and the response is flushed. Test
-        case provided by David Marcks. (kkolinko)
-      </fix>
-      <fix>
-        Replace unneeded call that iterated events queue in NioEndpoint.Poller.
-        (kkolinko)
-      </fix>
-      <fix>
-        Improve MimeHeaders.toString(). (kkolinko)
-      </fix>
-      <fix>
-        Allow the BIO HTTP connector to be used with SSL when running under Java
-        7. (markt) 
-      </fix>
-      <fix>
-        Improve multi-byte character handling in all connectors. (rjung)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Jasper">
-    <changelog>
-      <fix>
-        <bug>51220</bug>: Correct copy/paste error in original commit for this
-        issue. (markt)
-      </fix>
-      <fix>
-        <bug>52091</bug>: Address performance issues related to log creation
-        in TagHandlerPool. Patch provided by Taiki Sugawara. (markt)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Cluster">
-    <changelog>
-      <add>
-        <bug>51736</bug>: Make rpcTimeout configurable in BackupManager. 
-        (kfujino)
-      </add>
-      <add>
-        New cluster manager attribute <code>sessionAttributeFilter</code>
-        allows to filter which session attributes are replicated using a
-        regular expression applied to the attribute name. (rjung)
-      </add>
-      <fix>
-        Avoid an unnecessary session ID change notice. 
-        Notice of changed session ID by JvmRouteBinderValve is unnecessary to 
-        BackupManager. In BackupManager, change of session ID is replicated by 
-        the call of a setId() method. (kfujino)
-      </fix>
-      <fix>
-        Fix unneeded duplicate <code>resetDeltaRequest()</code> call in
-        <code>DeltaSession.setId(String)</code>. (kkolinko)
-      </fix>
-      <add>
-        When Context manager does not exist, no context manager message is 
-        replied in order to avoid timeout (default 60 sec) of 
-        GET_ALL_SESSIONS sync phase. (kfujino)
-      </add>
-    </changelog>
-  </subsection>
-  <subsection name="Web applications">
-    <changelog>
-      <fix>
-        Correct the documentation for the connectionLinger attribute of the HTTP
-        connector. (markt)
-      </fix>
-      <add>
-        Show build date and version in the header on every documentation
-        page. (kkolinko)
-      </add>
-      <fix>
-        <bug>52049</bug>: Improve setup instructions for running as a Windows
-        service: correct information on how a JRE is identified and selected.
-        (markt)
-      </fix>
-      <update>
-        <bug>52172</bug>: Clarify Tomcat build instructions. Patch provided
-        by bmargulies. (kkolinko)
-      </update>
-    </changelog>
-  </subsection>
-  <subsection name="Other">
-    <changelog>
-      <update>
-        Update the native component of the APR/native connectors to 1.1.22.
-        (markt)
-      </update>
-      <update>
-        Update the recommended version of the native component of the APR/native
-        connectors to 1.1.22. (kkolinko)
-      </update>
-      <update>
-        Update the Eclipse compiler (used for JSPs) to 3.7. (markt)
-      </update>
-      <fix>
-        Correct two typos in the Windows installer. (kkolinko)
-      </fix>
-      <fix>
-        <bug>52059</bug>: In Windows uninstaller: Do not forget to remove
-        Tomcat keys from 32-bit registry on deinstallation. (kkolinko)
-      </fix>
-    </changelog>
-  </subsection>
-</section>
-<section name="Tomcat 6.0.33 (jfclere)" rtext="released 2011-08-18">
-  <subsection name="Catalina">
-    <changelog>
-      <add>
-        Allow to search the virtual paths before the webapp or after it. (rjung)
-      </add>
-      <fix>
-        <bug>27988</bug>: Improve reporting of missing files. (markt)
-      </fix>
-      <fix>
-        <bug>28852</bug>: Add URL encoding where missing to parameters in URLs
-        presented by Ant tasks to the Manager application. Based on a patch by
-        Stephane Bailliez. (markt) 
-      </fix>
-      <add>
-        <bug>46252</bug>: Allow to specify character set to be used to write
-        the access log in AccessLogValve. (kkolinko)
-      </add>
-      <add>
-        <bug>48863</bug>: Provide an warning if there is a problem with a class
-        path entry but use debug level logging if it is expected due to catalina
-        home/base split. (kkolinko)
-      </add>
-      <add>
-        <bug>49180</bug>: Add an option to disable file rotation in JULI
-        FileHandler. (kkolinko)
-      </add>
-      <fix>
-        <bug>50189</bug>: Once the application has finished writing to the
-        response, prevent further reads from the request since this causes
-        various problems in the connectors which do not expect this. (markt)
-      </fix>
-      <fix>
-        <bug>50700</bug>: Ensure that the override attribute of context
-        parameters is correctly followed. (markt)
-      </fix>
-      <fix>
-        <bug>50734</bug>: Return 404 rather than 400 for requests to the ROOT
-        context when no ROOT context is deployed. Patch provided by Violeta
-        Georgieva. (markt)
-      </fix>
-      <fix>
-        <bug>50751</bug>: When authenticating with the JNDI Realm, only attempt
-        to read user attributes from the directory if attributes are required.
-        (markt)
-      </fix>
-      <fix>
-        <bug>50752</bug>: Fix typo in debug message in
-        <code>org.apache.catalina.startup.Embedded</code>. (markt)
-      </fix>
-      <fix>
-        <bug>50855</bug>: Fix NPE on AuthenticatorBase.register() when debug
-        logging is enabled. (markt)
-      </fix>
-      <fix>
-        Correctly format the timestamp reported by version.[sh|bat]. (markt)
-      </fix>
-      <fix>
-        Remove unnecessary whitespace from MIME mapping entries in global
-        web.xml file. (markt)
-      </fix>
-      <fix>
-        <bug>51042</bug>: Don&apos;t trigger session creation listeners when a
-        session ID is changed as part of the authentication process. (markt)
-      </fix>
-      <add>
-        <bug>51119</bug>: Add JAAS authentication support to the
-        JMXRemoteLifecycleListener. Patch provided by Neil Laurance. (markt) 
-      </add>
-      <update>
-        Implement display of multiple request headers in AccessLogValve:
-        print not just the value of the first header, but of the all of them,
-        separated by commas. (kkolinko)
-      </update>
-      <fix>
-        Correct the SSLValve so it returns the SSL key size as an Integer rather
-        than as a String. (markt)
-      </fix>
-      <fix>
-        <bug>51162</bug>: Prevent possible NPE when removing a web application.
-        (markt)
-      </fix>
-      <fix>
-        <bug>51249</bug>: Improve system property replacement code
-        in ClassLoaderLogManager of Tomcat JULI to cover some corner cases.
-        (kkolinko)
-      </fix>
-      <fix>
-        <bug>51315</bug>: Fix IAE when removing an authenticator valve from a
-        container. Patch provided by Violeta Georgieva. (markt)
-      </fix>
-      <fix>
-        <bug>51324</bug>: Improve handling of exceptions when flushing the
-        response buffer to ensure that the doFlush flag does not get stuck in
-        the enabled state. Patch provided by Jeremy Norris. (kkolinko)
-      </fix>
-      <fix>
-        <bug>51348</bug>: Fix possible NPE when processing WebDAV locks. (markt)
-      </fix>
-      <add>
-        Add a container event that is fired when a session&apos;s ID is changed,
-        e.g. on authentication. (markt)
-      </add>
-      <fix>
-        Fix CVE-2011-2204. Prevent user passwords appearing in log files if a
-        runtime exception (e.g. OOME) occurs while creating a new user for a
-        MemoryUserDatabase via JMX. (markt)
-      </fix>
-      <fix>
-        <bug>51400</bug>: Avoid jvm bottleneck on String/byte[] conversion
-        triggered by a JVM bug. Based on patches by Dave Engberg and Konstantin
-        Prei&#223;er. (markt)
-      </fix>
-      <add>
-        <bug>51403</bug>: Avoid NPE in JULI FileHandler if formatter is
-        misconfigured. (kkolinko)
-      </add>
-      <update>
-        Create a directory for access log or error log (in AccessLogValve and
-        in JULI FileHandler) automatically when it is specified as a part of
-        the file name, e.g. in the <code>prefix</code> attribute. Earlier this
-        happened only if it was specified with the <code>directory</code>
-        attribute. (kkolinko)
-      </update>
-      <fix>
-        Log a failure if access log file cannot be opened. Improve i18n
-        of messages. (kkolinko)
-      </fix>
-      <fix>
-        Improve handling of URLs with path parameters and prevent incorrect 404
-        responses that could occur when path parameters were present. (kkolinko)
-      </fix>
-      <fix>
-        <bug>51473</bug>: Fix concatenation of values in
-        <code>SecurityConfig.setSecurityProperty()</code>. (kkolinko)
-      </fix>
-      <fix>
-        <bug>51509</bug>: Fix potential concurrency issue in CSRF prevention
-        filter that may lead to some requests failing that should not. (markt)
-      </fix>
-      <fix>
-        <bug>51588</bug>: Make it easier to extend the AccessLogValve to add
-        support for custom elements. (markt)
-      </fix>
-      <fix>
-        Unregister DataSource MBeans when web application stops. (kfujino)
-      </fix>
-      <add>
-        CVE-2011-1184: Add additional configuration options to the DIGEST
-        authenticator. (markt)
-      </add>
-    </changelog>
-  </subsection>
-  <subsection name="Coyote">
-    <changelog>
-      <fix>
-        Reduce level of log message for invalid URL parameters from WARNING to
-        INFO. (kkolinko) 
-      </fix>
-      <add>
-        <bug>48208</bug>: Provide an option to specify a custom trust manager
-        for BIO and NIO HTTP connectors using SSL. Based on a patch by Luciana
-        Moreira. (markt)
-      </add>
-      <fix>
-        <bug>49595</bug>: Protect against crashes when using the APR/native
-        connector. (jfclere)
-      </fix>
-      <fix>
-        <bug>49929</bug>: Make sure flush packet is not send after END_RESPONSE
-        packet. (mturk/markt) 
-      </fix>
-      <add>
-        <bug>50887</bug>: Enable the provider to be configured when generating
-        SSL certs. Based on a patch by pknopp. (markt)
-      </add>
-      <fix>
-        <bug>51073</bug>: Throw an exception and do not start the APR connector
-        if it is configured for SSL and an invalid value is provided for
-        SSLProtocol. (markt)
-      </fix>
-      <fix>
-        Fix CVE 2011-2526. Protect against infinite loops (HTTP NIO) and crashes
-        (HTTP APR) if sendfile is configured to send more data than is available
-        in the file. (markt)
-      </fix>
-      <fix>
-        Prevent NPEs when a socket is closed in non-error conditions after
-        sendfile processing when using the HTTP NIO connector. (markt) 
-      </fix>
-      <fix>
-        <bug>51515</bug>: Prevent immediate socket close when comet is used over
-        HTTPS. (markt)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Jasper">
-    <changelog>
-      <fix>
-        <bug>36362</bug>: Handle the case where tag file attributes (which can
-        use any valid XML name) have a name which is not a Java identifier.
-        (markt)
-      </fix>
-      <fix>
-        <bug>47371</bug>: Correctly coerce the empty string to zero when used as
-        an operand in EL arithmetic. Patch provided by gbt. (markt)
-      </fix>
-      <fix>
-        <bug>50726</bug>: Ensure that the use of the genStringAsCharArray does
-        not result in String constants that are too long for valid Java code.
-        (markt)
-      </fix>
-      <fix>
-        <bug>50895</bug>: Don&apos;t initialize classes created during the
-        compilation stage. (markt)
-      </fix>
-      <add>
-        <bug>51124</bug>: Make Tomcat more robust if an OOME occurs. Usually
-        after an OOME all bets are off but this change appears to help some
-        users and the description of a &apos;recoverable&apos; OOME in the bug
-        is a plausible one. Based on a patch by Ramiro. (markt)
-      </add>
-      <fix>
-        <bug>51177</bug>: Ensure Tomcat&apos;s MapELResolver and ListELResolver
-        always return <code>Object.class</code> for <code>getType()</code> as
-        required by the EL specification. (markt)
-      </fix>
-      <fix>
-        Correct possible threading issue in JSP compilation when development
-        mode is used. (markt)
-      </fix>
-      <add>
-        <bug>51220</bug>: Add a system property to enable tag pooling with JSPs
-        that use a custom base class. Based on a patch by Dan Mikusa. (markt)
-      </add>
-      <add>
-        Broaden the exception handling in the EL Parser so that more failures to
-        parse an expression include the failed expression in the exception
-        message. Hopefully, this will help track down the cause of
-        <bug>51088</bug>. (markt)
-      </add>
-      <add>
-        Improve error reporting of Jasper compilation. (schultz)
-      </add>
-    </changelog>
-  </subsection>
-  <subsection name="Cluster">
-    <changelog>
-      <fix>
-        <bug>50646</bug>: Fix cluster message data corruption if message size
-        exceeds the underlying buffer size. Patch provided by Olivier Costet.
-        (markt)
-      </fix>
-      <fix>
-        <bug>50771</bug>: Ensure HttpServletRequest#getAuthType() returns the 
-        name of the authentication scheme if request has already been 
-        authenticated. (kfujino)
-      </fix>
-      <fix>
-        <bug>50950</bug>: Correct possible NotSerializableException for an
-        authenticated session when running with a security manager. (markt)
-      </fix>
-      <fix>
-        <bug>51306</bug>: Avoid NPE when handleSESSION_EXPIRED is processed 
-        while handleSESSION_CREATED is being processed. (kfujino)
-      </fix>
-      <fix>
-        The change in session ID is notified to the container event listener on 
-        the backup node in cluster. This notification is controlled by 
-        notifyContainerListenersOnReplication. (kfujino)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Web applications">
-    <changelog>
-      <fix>
-        <bug>41498</bug>: Add the allRolesMode attribute to the Realm
-        configuration page in the documentation web application. (markt)
-      </fix>
-      <fix>
-        <bug>48997</bug>: Fixed some typos and improve cross-referencing to the
-        HTTP Connector and APR documentation with the SSL How-To page of the
-        documentation web application. (markt)
-      </fix>
-      <fix>
-        <bug>50804</bug>: Update links for Servlet 2.5 and JSP 2.1 Javadoc.
-        (markt)
-      </fix>
-      <update>
-        Improve class loading documentation and logging documentation.
-        (kkolinko)
-      </update>
-      <update>
-        Configure Security Manager How-To to include a copy of the actual
-        conf/catalina.policy file when the documentation is built, rather
-        than maintaining a copy of its content. (kkolinko)
-      </update>
-      <fix>
-        <bug>51147</bug>: Fix deployment via HTML Manager that was broken by
-        addition of CRSF protection. Patch provided by Alexis Hassler. (markt)
-      </fix>
-      <fix>
-        <bug>51156</bug>: Ensure session expiration option is available in
-        Manager application was running web applications that were defined in
-        server.xml. (markt)
-      </fix>
-      <fix>
-        Correct the log4j configuration settings when defining conversion
-        patterns in the documentation web application. (markt)
-      </fix>
-      <fix>
-        Update Maven repository information in the documentation to reflect
-        current usage. (markt)
-      </fix>
-      <fix>
-        <bug>51346</bug>: Update the documentation web application to make clear
-        the circumstances in which the RequestDumperValve will consume the
-        request&apos;s InputStream. Based on a patch by pid. (markt)
-      </fix>
-      <fix>
-        <bug>51443</bug>: Document the notifySessionListenersOnReplication
-        attribute for the DeltaManager. (markt)
-      </fix>
-      <fix>
-        <bug>51516</bug>: Correct documentation web application to show correct
-        system property name for changing the name of the SSO session cookie.
-        (markt)
-      </fix>
-      <update>
-        Update documentation to be even more explicit about the implications
-        of setting the <code>path</code> attribute on a <code>Context</code>
-        element in <code>server.xml</code>. (markt/kkolinko)
-      </update>
-    </changelog>
-  </subsection>
-  <subsection name="Other">
-    <changelog>
-      <update>
-        Clarify error messages in *.sh files to mention that if a script is
-        not found it might be because execute permission is needed. (kkolinko)
-      </update>
-      <add>
-        <bug>33262</bug>, <bug>40510</bug>, <bug>50949</bug>, <bug>51135</bug>:
-        Various improvements to the Windows installer to be able to install
-        several copies of Tomcat 6 side by side. Allow to configure service
-        name, connector and shutdown ports. Allow to choose whether to install
-        Start menu shortcuts and Apache Tomcat monitor application for all
-        users or for the current one only. Improve auto-detection of JAVA_HOME
-        for 64-bit Windows platforms: autoselect 32-bit JRE if it exists and
-        64-bit one is not available. Improve server.xml file handling.
-        Fix uninstallation icon. (markt/kkolinko)
-      </add>
-      <fix>
-        <bug>50854</bug>: Add additional entries to the default catalina.policy
-        file to support running the manager web application from CATALINA_HOME
-        or CATALINA_BASE. (markt) 
-      </fix>
-      <fix>
-        Update default download sources to use the central Apache Maven 2
-        repository as some libraries have been removed from the central Apache
-        Maven 1 repository. (kkolinko)
-      </fix>
-      <fix>
-        <bug>51155</bug>: Add comments to @deprecated tags that have none. Patch
-        provided by sebb. (kkolinko)
-      </fix>
-      <fix>
-        <bug>51309</bug>: Correct logic in catalina.sh stop when using a PID
-        file to ensure the correct message is shown. Patch provided by Caio
-        Cezar. (markt)
-      </fix>
-      <update>
-        Update Apache Commons Pool to 1.5.6. (kkolinko)
-      </update>
-      <update>
-        Update Apache Commons Daemon to 1.0.7. (kkolinko)
-      </update>
-      <update>
-        At build time use two alternative download locations for components
-        downloaded from apache.org. (kkolinko)
-      </update>
-    </changelog>
-  </subsection>
-</section>
-<section name="Tomcat 6.0.32 (jfclere)" rtext="released 2011-02-03">
-  <subsection name="Catalina">
-    <changelog>
-      <update>
-        <bug>48822</bug>: Include context name in reload and stop log statements.
-        Based on the patch provided by Marc Guillemot. (kkolinko)
-      </update>
-      <fix>
-        <bug>50673</bug>: Improve Catalina shutdown when running as a service.
-        Do not call System.exit(). (kkolinko)
-      </fix>
-      <fix>
-        <bug>50689</bug>: Provide 100 Continue responses at appropriate points
-        during FORM authentication if client indicates that they are expected.
-        (kkolinko)
-      </fix>
-      <fix>
-        Improve HTTP specification compliance in support of
-        <code>Accept-Language</code> header. This protects from known exploit
-        of the Oracle JVM bug that triggers a DoS, CVE-2010-4476. (kkolinko)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Coyote">
-    <changelog>
-      <fix>
-        <bug>49795</bug>: Backport AprEndpoint shutdown improvements, to make
-        it more robust. (mturk/kkolinko)
-      </fix>
-      <fix>
-        <bug>50325</bug>: When the JVM indicates support for RFC 5746, disable
-        Tomcat&apos;s <code>allowUnsafeLegacyRenegotiation</code> configuration
-        attribute and use the JVM configuration to control renegotiation.
-        (markt)
-      </fix>
-      <fix>
-        <bug>50631</bug>: InternalNioInputBuffer should honor
-        <code>maxHttpHeadSize</code>. (kkolinko)
-      </fix>
-      <fix>
-        <bug>50651</bug>: Fix NPE in InternalNioOutputBuffer.recycle().
-        (kkolinko)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Cluster">
-    <changelog>
-      <fix>
-        Be consistent with locks on sessionCreationTiming,
-        sessionExpirationTiming in DeltaManager.resetStatistics(). (kkolinko)
-      </fix>
-    </changelog>
-  </subsection>
-</section>
-<section name="Tomcat 6.0.31 (jfclere)" rtext="not released">
-  <subsection name="Catalina">
-    <changelog>
-      <fix>
-        <bug>49543</bug>: Allow Tomcat to use shared data sources with per
-        application credentials. (fhanik)
-      </fix>
-      <add>
-        <bug>50205</bug>: Add the deployIgnorePaths attribute to the Host
-        element. Based on a patch by Jim Riggs. (markt/kkolinko)
-      </add>
-      <fix>
-        <bug>50413</bug>: Additional fix that ensures the error page is served
-        regardless of any Range headers in the original request. (kkolinko)
-      </fix>
-      <fix>
-        <bug>50550</bug>: When a new directory is created (e.g. via WebDAV)
-        ensure that a subsequent request for that directory does not result in a
-        404 response. (markt/kkolinko)
-      </fix>
-      <add>
-        Provide session creation and destruction rate metrics in the session
-        managers. (markt) 
-      </add>
-      <fix>
-        <bug>50606</bug>: Improve CGIServlet: Provide support for specifying
-        empty value for the <code>executable</code> init-param. Provide support
-        for explicit additional arguments for the executable. Those were
-        broken when implementing fix for bug <bug>49657</bug>. (kkolinko)
-      </fix>
-      <fix>
-        <bug>50620</bug>: Stop exceptions that occur during
-        <code>Session.endAccess()</code> from preventing the normal completion
-        of <code>Request.recycle()</code>. (markt)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Coyote">
-    <changelog>
-      <fix>
-        Remove a huge memory leak in the NIO connector introduced by the fix
-        for <bug>49884</bug>. (markt)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Cluster">
-    <changelog>
-      <fix>
-        <bug>50600</bug>: Prevent a <code>ConcurrentModificationException</code>
-        when removing a WAR file via the FarmWarDeployer. (markt)
-      </fix>
-    </changelog>
-  </subsection>
-</section>
-<section name="Tomcat 6.0.30 (jfclere)" rtext="released 2011-01-13">
-  <subsection name="General">
-    <changelog>
-      <fix>
-        Filter input of manager app servlets. (kkolinko)
-      </fix>
-      <fix>
-        <bug>43960</bug>: Expose available property of StandardWrapper via JMX.
-        (markt)
-      </fix>
-      <update>
-        Update to Commons Daemon 1.0.5. (mturk)
-      </update>
-      <update>
-        Switch to using the Eclipse compiler JAR directly rather than creating
-        it from the larger JDT download. (markt)
-      </update>
-      <add>
-        Allow the off-line building of the extras package. (markt)
-      </add>
-      <update>
-        Update to Commons Pool 1.5.5. (markt)
-      </update>
-      <fix>
-        <bug>49728</bug>, <bug>50084</bug>: Improve PID file handling when
-        another process is managing the PID file and Tomcat does not have write
-        access. (markt)
-      </fix>
-      <fix>
-        <bug>49909</bug>, <bug>50201</bug>: Provide a mechanism to log requests
-        rejected before they reach the AccessLogValve to appear in the access
-        log. (markt/kkolinko)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Catalina">
-    <changelog>
-      <fix>
-        <bug>38113</bug>: Provide a system property that enables a strict
-        interpretation of the specification for <code>getQueryString()</code>
-        when an empty query string is provided by the user agent. (markt)
-      </fix>
-      <fix>
-        Return a copy of the current URLs for the <code>WebappClassLoader</code>
-        to prevent modification. This facilitated, although it wasn't the root
-        cause, CVE-2010-1622. (markt)
-      </fix>
-      <add>
-        <bug>48837</bug>: Extend thread local memory leak detection to include
-        classes loaded by subordinate class loaders to the web
-        application&apos;s class loader such as the Jasper class loader.
-        Patch provided by Sylvain Laurent. (kkolinko)
-      </add>
-      <add>
-        <bug>48973</bug>: Avoid creating a SESSIONS.ser file when stopping an 
-        application if there's no session. Patch provided by Marc Guillemot.
-        (slaurent)
-      </add>
-      <fix>
-        <bug>49030</bug>: Failure during start of one connector should not leave
-        some connectors started and some ignored. (kkolinko)
-      </fix>
-      <fix>
-        <bug>49195</bug>: Don't report an error when shutting down a Windows
-        service for a Tomcat instance that has a disabled shutdown port. (markt)
-      </fix>
-      <fix>
-        <bug>49209</bug>: Fix problem with JDBC driver memory leak prevention
-        when running under a security manager. Patch provided by Sylvain
-        Laurent. (markt)
-      </fix>
-      <fix>
-        <bug>49613</bug>: Improve performance when using SSL for applications
-        that make multiple class to <code>Request.getAttributeNames()</code>.
-        Patch provided by Sampo Savolainen. (markt)
-      </fix>
-      <fix>
-        <bug>49657</bug>: Handle CGI executables with spaces in the path.
-        (markt)
-      </fix>
-      <fix>
-        <bug>49667</bug>: Ensure that using the JDBC driver memory leak
-        prevention code does not cause a one of the memory leaks it is meant to
-        avoid. (markt)
-      </fix>
-      <fix>
-        <bug>49749</bug>: Respect <code>httpOnly</code> setting of Context
-        when creating SSO cookie. (markt)
-      </fix>
-      <add>
-        Provide better web application state information via JMX. (markt)
-      </add>
-      <add>
-        <bug>49811</bug>: Add an option to disable URL rewriting on a per
-        Context basis. The option name is <code>disableURLRewriting</code>.
-        (markt)
-      </add>
-      <add>
-        <bug>49856</bug>: Expose the executor name for the connector via JMX.
-        (markt)
-      </add>
-      <fix>
-        <bug>49915</bug>: Make error more obvious, particularly when accessed
-        via JConsole, if StandardServer.storeConfig() is called when there is
-        no StoreConfig implementation present. (markt)
-      </fix>
-      <fix>
-        <bug>49965</bug>: Use correct i18n resources for StringManager in
-        JAASRealm. (kkolinko)
-      </fix>
-      <fix>
-        <bug>49987</bug>: Fix potential data race in the population of the
-        Servlet Context initialisation parameters. (markt)
-      </fix>
-      <fix>
-        Code clean-up. Avoid some casts in StandardContext. (markt)
-      </fix>
-      <add>
-        Add security policy and token poller protection to the JRE memory leak
-        protection provided in Tomcat 6. (markt/kkolinko)
-      </add>
-      <add>
-        <bug>50026</bug>: Add support for mapping the default servlet to URLs
-        other than /. (timw)
-      </add>
-      <fix>
-        <bug>50128</bug>: Improve exception handling in PersistentManagerBase
-        when running with a security manager. (kkolinko)
-      </fix>
-      <fix>
-        <bug>50131</bug>: Avoid possible NPE in debug output in PersistentValve.
-        Patch provided by sebb. (kkolinko)
-      </fix>
-      <fix>
-        <bug>50138</bug>: Fix threading issues in
-        <code>org.apache.catalina.security.SecurityUtil</code>. (markt)
-      </fix>
-      <add>
-        Add a new filter, <code>org.apache.catalina.filters.CsrfPreventionFilter</code>,
-        to provide generic cross-site request forgery (CSRF)
-        protection for web applications. (markt)
-      </add>
-      <fix>
-        Make sure Contexts defined in server.xml pick up any <code>configClass</code>
-        setting from the parent Host. (markt)
-      </fix>
-      <add>
-        <bug>50222</bug>: Modify memory leak prevention code so it pins the
-        system class loader in memory rather than than the common class loader,
-        which is better for embedded systems. (schultz) 
-      </add>
-      <add>
-        Make memory leak prevention code that clears ThreadLocal instances more
-        robust against objects with <code>toString()</code> methods that throw
-        exceptions. (markt)
-      </add>
-      <add>
-        <bug>50282</bug>: Load <code>javax.security.auth.login.Configuration</code>
-        with <code>JreMemoryLeakPreventionListener</code> to avoid memory leak
-        when stopping a webapp that would use JAAS.
-        (slaurent)
-      </add>
-      <fix>
-        <bug>50413</bug>: Ensure 304s are not returned when using static files
-        as error pages. (markt)
-      </fix>
-      <fix>
-        <bug>50453</bug>: Correctly handle multiple <code>X-Forwarded-For</code>
-        headers in the RemoteIpValve. Patch provided by Jim Riggs. (markt)
-      </fix>
-      <fix>
-        <bug>50459</bug>: Fix thread/classloader binding issues in
-        StandardContext. (slaurent) 
-      </fix>
-      <update>
-        <bug>50527</bug>: Improve an error message shown by HttpServlet. (markt)
-      </update>
-      <add>
-        <bug>50556</bug>: Improve JreMemoryLeakPreventionListener to prevent
-        a potential class loader leak caused by a thread spawned when the class
-        <code>com.sun.jndi.ldap.LdapPoolManager</code> is initialized and the 
-        system property <code>com.sun.jndi.ldap.connect.pool.timeout</code> is 
-        set to a value greater than 0. (slaurent)
-      </add>
-      <fix>
-        <bug>50642</bug>: Move the <code>sun.net.www.http.HttpClient</code>
-        keep-alive thread memory leak protection from the 
-        JreMemoryLeakPreventionListener to the WebappClassLoader since the
-        thread that triggers the memory leak is created on demand. (markt)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Coyote">
-    <changelog>
-      <fix>
-        <bug>47913</bug>: Return the IP address rather than null for
-        <code>getRemoteHost()</code> with the APR connector if the IP address
-        does not resolve. (markt)
-      </fix>
-      <fix>
-        Avoid a NPE for APR connector unlockAccept with default soTimeout.
-        (mturk)
-      </fix>
-      <add>
-        <bug>48545</bug>: Allow JSSE trust stores to be used without providing
-        a password. Based on a patch by smmwpf54. (kkolinko)
-      </add>
-      <add>
-        <bug>48738</bug>: Add support for flushing gzipped output. Based on a
-        patch by Jiong Wang. (markt)
-      </add>
-      <fix>
-        Avoid a NPE in the DeltaManager when a parallel request invalidates the
-        session before the current request has a chance to send the replication
-        message. (markt)
-      </fix>
-      <fix>
-        <bug>48925</bug>: <code>request.getLocalAddr()</code> returns
-        <code>null</code> when using the default Jk AJP/1.3 connector. (rjung)
-      </fix>
-      <fix>
-        <bug>49497</bug>: Stop accepting new requests (inc keep-alive) once the
-        BIO connector is paused and the current request has finished processing.
-        (markt)
-      </fix>
-      <fix>
-        <bug>49521</bug>: Disable scanning for a free port in Jk AJP/1.3
-        connector by default. Do not change <code>maxPort</code> field value of ChannelSocket
-        in its <code>setPort()</code> and <code>init()</code> methods. Add
-        support for <code>maxPort</code> attribute on a <code>Connector</code>
-        element as a synonym for <code>channelSocket.maxPort</code>. (kkolinko)
-      </fix>
-      <fix>
-        <bug>49625</bug>: Ensure Vary header is set if response may be
-        compressed rather than only setting it if it is compressed. (markt)
-      </fix>
-      <fix>
-        <bug>49730</bug>: Fix race condition in StandardThreadExecutor that can
-        lead to long delays in processing requests. Patch provided by Sylvain
-        Laurent. (markt)
-      </fix>
-      <fix>
-        <bug>49860</bug>: Add support for trailing headers in chunked HTTP
-        requests. The header length is limited to 8192 by default and the limit
-        can be changed via a system property. (markt/kkolinko)
-      </fix>
-      <fix>
-        <bug>49972</bug>: Fix potential thread safe issue when formatting dates
-        for use in HTTP headers. (markt)
-      </fix>
-      <fix>
-        <bug>50072</bug>: NIO connector can mis-read request line if not sent in
-        a single packet. (markt/kkolinko)
-      </fix>
-      <fix>
-        Improve recycling of processors in Http11NioProtocol. (kkolinko)
-      </fix>
-      <add>
-        <bug>50273</bug>: Provide a workaround for an HP-UX issue that can
-        result in large numbers of SEVERE log messages appearing in the logs as
-        a result of normal operation. (markt)
-      </add>
-      <fix>
-        Make SSL certificate encoding algorithm consistent between connectors by
-        using the JVM default for all connectors. This also fixes an issue with
-        the NIO connector on IBM JVMs. (markt)
-      </fix>
-      <fix>
-        <bug>50467</bug>: Protected against NPE triggered by a race condition
-        that causes the NIO poller to fail, preventing the processing of further
-        requests. (markt)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Jasper">
-    <changelog>
-      <update>
-        <bug>49217</bug>: Ensure that identifiers used in EL meet the
-        requirements of the Java Language Specification. This check is off by
-        default and can be enabled by setting a system property. (markt)
-      </update>
-      <fix>
-        <bug>49555</bug>: Correctly handled Tag Libraries where functions are
-        defined in static inner classes. (markt)
-      </fix>
-      <fix>
-        <bug>49665</bug>: Provide better information including JSP file name and
-        location when a missing file is detected during TLD handling. Patch
-        provided by Ted Leung. (markt)
-      </fix>
-      <fix>
-        <bug>49985</bug>: Fix thread safety issue in EL parser. (markt)
-      </fix>
-      <fix>
-        <bug>49986</bug>: Fix thread safety issue in JSP reloading. (timw))
-      </fix>
-      <fix>
-        <bug>49998</bug>: Make jsp:root detection work with single quoted
-        attributes as well. (timw)
-      </fix>
-      <fix>
-        <bug>50066</bug>: Compile a recursive tag file if it depends on a JAR.
-        Patch provided by Sylvain Laurent. (markt)
-      </fix>
-      <fix>
-        <bug>50078</bug>: Fix threading issues in EL caches and make cache sizes
-        configurable. Threading patch provided by Takayoshi Kimura. (markt)
-      </fix>
-      <fix>
-        <bug>50105</bug>: When processing composite EL expressions use
-        <code>Enum.name()</code> rather than <code>Enum.toString()</code> as
-        required by the EL specification. (markt)
-      </fix>
-      <fix>
-        <bug>50228</bug>: Improve recycling of <code>BodyContentImpl</code>.
-        This avoids keeping a cached reference to a webapp-provided Writer
-        used in JspFragment.invoke() calls. (kkolinko)
-      </fix>
-      <fix>
-        <bug>50460</bug>: Fix memory leak in JspDocumentParser triggered by
-        first access to a jspx page. (kkolinko)
-      </fix>
-      <fix>
-        <bug>50500</bug>: Use correct coercions (as per the EL spec) for
-        arithmetic operations involving string values containing &apos;.&apos;,
-        &apos;e&apos; or &apos;E&apos;. Based on a patch by Brian Weisleder.
-        (markt)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Cluster">
-    <changelog>
-      <fix>
-        <bug>49343</bug>: When ChannelException is thrown, remove listener from
-        channel. (kfujino)
-      </fix>
-      <fix>
-        Add Null check when CHANGE_SESSION_ID message received. (kfujino)
-      </fix>
-      <fix>
-        When a cluster node disappears when using the backup manager, handle the
-        failed ping message rather than propagating the exception (which just
-        logs the stack trace but doesn't do anything to deal with the failure).
-        (markt)
-      </fix>
-      <fix>
-        <bug>49905</bug>: Fix potential memory leak when using asynchronous
-        session replication. (markt)
-      </fix>
-      <fix>
-        <bug>49924</bug>: When non-primary node changes into a primary node,
-        make sure isPrimarySession is changed to true. (kfujino)
-      </fix>
-      <fix>
-        Add support for <code>maxActiveSessions</code> attribute to
-        BackupManager. (kfujino)
-      </fix>
-      <fix>
-        Improve sending an access message in DeltaManager.
-        Use <code>maxInactiveInterval</code> not of the Manager, but of the session. 
-        If <code>maxInactiveInterval</code> is negative, the access message is not
-        being sent. (kfujino)
-      </fix>
-      <fix>
-        <bug>50547</bug>: Add time stamp for CHANGE_SESSION_ID message and 
-        SESSION_EXPIRED message. (kfujino)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Web applications">
-    <changelog>
-      <fix>
-        <bug>49585</bug>: Update JSVC documentation to reflect new packaging
-        of Commons Daemon. (markt)
-      </fix>
-      <add>
-        Configure the Manager web application to use the new CSRF protection. To
-        take advantage of this protection, the <code>manager</code> role must be
-        removed from all users and the new <code>manager-gui</code> and
-        <code>manager-script</code> roles used instead. (markt)
-      </add>
-      <add>
-        Configure the Host Manager web application to use the new CSRF
-        protection. To take advantage of this protection, the <code>admin</code> role
-        must be removed from all users and the new <code>admin-gui</code> and
-        <code>admin-script</code> roles used instead. (markt)
-      </add>
-      <fix>
-        <bug>50303</bug>: Update JNDI how-to to reflect new JavaMail and JAF
-        download locations and that JAF is now included in Java SE 6. (markt) 
-      </fix>
-      <fix>
-        CVE-2010-4172: Multiple XSS in Manager application. (markt/kkolinko)
-      </fix>
-      <update>
-        Improve Tomcat Logging documentation. (kkolinko)
-      </update>
-      <add>
-        <bug>50242</bug>: Provide a sample log4j  configuration that more
-        closely matches the default JULI configuration. Patch provided by
-        Christopher Schultz. (kkolinko)
-      </add>
-      <add>
-        <bug>50294</bug>: Add more information to documentation regarding format
-        of configuration files. Patch provided by Luke Meyer. (markt) 
-      </add>
-      <update>
-        Configure the Manager and Host-Manager web applications to use HttpOnly
-        flag for their session cookies. (kkolinko)
-      </update>
-      <fix>
-        <bug>50316</bug>: Fix display of negative values in the Manager web
-        application. (kkolinko)
-      </fix>
-      <update>
-        Improve documentation of database connection factory. (rjung)
-      </update>
-    </changelog>
-  </subsection>
-  <subsection name="Other">
-    <changelog>
-      <update>
-        <bug>48716</bug>: Do not call reset if the default LogManager is in use.
-        (markt)
-      </update>
-      <fix>
-        Use native line endings for example Eclipse configuration files in
-        source distribution. (markt)
-      </fix>
-      <fix>
-        <bug>49428</bug>: Add a work-around for the known namespace issues for
-        some Microsoft WebDAV clients. Based on the patch provided by
-        Panagiotis Astithas. (kkolinko)
-      </fix>
-      <fix>
-        <bug>49861</bug>: Fix formatting of log messages in JXM remote listener.
-        Do not use commas when printing RMI port numbers. (markt)
-      </fix>
-      <fix>
-        <bug>50140</bug>: Don&apos;t ignore a user specified install directory
-        on 64-bit platforms when using the Windows installer. (markt)
-      </fix>
-      <fix>
-        <bug>50552</bug>: Avoid NPE that hides error message when using Ant
-        tasks. (schultz)
-      </fix>
-      <update>
-        Numerous improvements to the Windows installer: update install/uninstall
-        icons, create an installation log, allow 32-bit JVMs to be selected when
-        installing on a 64-bit platform, replace the .ini files with the script
-        equivalents, use the new manager and host-manager roles, provide the
-        ability to edit the roles for the added user, add support for the
-        <code>/?</code> command line switch, clean up fully after installation,
-        add DetailPrint statements for operations that may take time and
-        improve the descriptions of the components. (kkolinko, mturk, markt)
-      </update>
-    </changelog>
-  </subsection>
-</section>
-<section name="Tomcat 6.0.29 (jfclere)" rtext="released 2010-07-22">
-  <subsection name="Catalina">
-    <changelog>
-      <add>
-        <bug>48960</bug>: Add a new option to the SSI Servlet and SSI Filter to
-        allow the disabling of the <code>exec</code> command. This is now
-        disabled by default. Based on a patch by Yair Lenga. (markt)
-      </add>
-      <fix>
-        <bug>49551</bug>: Allow default context.xml location to be specified
-        using an absolute path. (markt)
-      </fix>
-      <fix>
-        <bug>49598</bug>: When session is changed and the session cookie is
-        replaced, ensure that the new Set-Cookie header overwrites the old
-        Set-Cookie header. (markt)
-      </fix>
-      <fix>
-        Fix order when listing Webapp loader search URLs. (rjung)
-      </fix>
-      <add>
-        Add support for <code>*.jar</code> pattern in VirtualWebappLoader.
-        (kkolinko)
-      </add>
-    </changelog>
-  </subsection>
-</section>
-<section name="Tomcat 6.0.28 (jfclere)" rtext="released 2010-07-09">
-  <subsection name="Catalina">
-    <changelog>
-      <fix>Arrange filter logic. (jfclere)
-      </fix>
-      <fix>
-        <bug>49230</bug>: Enhance JRE leak prevention listener with protection
-        for the keep-alive thread started by
-        <code>sun.net.www.http.HttpClient</code>. Patch provided by Rob Kooper.
-        (markt)
-      </fix>
-      <fix>
-        <bug>49351</bug>: Fix possible NPE when embedding and no name is
-        specified for the Service. (markt)
-      </fix>
-      <fix>
-        <bug>49424</bug>: Avoid NPE if client provides no data with a chunked
-        POST request. (markt)
-      </fix>
-      <fix>
-        <bug>49414</bug>: Improve diagnostic of memory leaks.
-        Differentiate between request threads and application
-        created threads when warning about still running threads when an
-        application stops. (markt)
-      </fix>
-      <fix>
-        <bug>49443</bug>: Fix RemoteIpValve documentation. Use remoteIpHeader
-        rather than remoteIPHeader consistently. (markt)
-      </fix>
-      <add>
-        Add property <code>searchExternalFirst</code> to WebappLoader.
-        If set, the external repositories will be searched before
-        the WEB-INF ones. (rjung)
-      </add>
-    </changelog>
-  </subsection>
-  <subsection name="Cluster">
-    <changelog>
-      <fix>
-        <bug>49445</bug>: When session ID is changed after authentication,
-        ensure the DeltaManager replicates the change in ID to the other nodes
-        in the cluster. (kfujino)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Web applications">
-    <changelog>
-      <fix>
-        <bug>49213</bug>: Grant permissions required by manager application when
-        running under a security manager. (markt/kkolinko)
-      </fix>
-      <fix>
-        <bug>49436</bug>: Correct documented default for <code>readonly</code>
-        attribute of the UserDatabase component. (markt)
-      </fix>
-    </changelog>
-  </subsection>
-</section>
-<section name="Tomcat 6.0.27 (jfclere)" rtext="not released">
-  <subsection name="General">
-    <changelog>
-      <update>
-        Update DBCP to 1.3. (markt)
-      </update>
-    </changelog>
-  </subsection>
-  <subsection name="Catalina">
-    <changelog>
-      <fix>
-        Fix CVE-2010-1157. Prevent possible disclosure of host name or IP
-        address via the HTTP WWW-Authenticate header when using BASIC or DIGEST
-        authentication. (markt)
-      </fix>
-      <add>
-        Include context name when reporting memory leaks to aid root cause
-        identification. (markt)
-      </add>
-      <fix>
-        Improve exception handling on session de-serialization to assist in
-        identifying the root cause of <bug>48007</bug>. (kkolinko)
-      </fix>
-      <add>
-        <bug>48379</bug>: Make session cookie name, domain and path configurable
-        per context. (markt)
-      </add>
-      <fix>
-        <bug>48589</bug>: Make JNDIRealm easier to extend. Based on a patch by
-        Candid Dauth. (markt/kkolinko)
-      </fix>
-      <fix>
-        <bug>48629</bug>: Allow user names as well as DNs to be used with the
-        nested role search. Add roleNested to the documentation. Patch provided
-        by Felix Schumacher. (markt)
-      </fix>
-      <fix>
-        <bug>48661</bug>: Make error page behavior consistent, regardless of how
-        the error page is defined. If a response has been committed, always
-        include the error page. (markt)
-      </fix>
-      <fix>
-        <bug>48729</bug>: Return roles defined by both userRoleName and roleName
-        mechanisms. Patch provided by 'eric'. Also make user's role list
-        immutable.(markt)
-      </fix>
-      <fix>
-        <bug>48760</bug>: Fix potential multi-threading issue in static resource
-        serving where multiple threads could try to use the the same
-        InputStream. (markt)
-      </fix>
-      <fix>
-        <bug>48790</bug>: Fix thread safety issue in the count of the maximum
-        number of active session. (markt/kkolinko)
-      </fix>
-      <fix>
-        <bug>48793</bug>: Make catalina.sh more robust to different return
-        values on different platforms. Patch provided by Thomas GL. (markt)
-      </fix>
-       <fix>
-        <bug>48840</bug>: Swallow output (if any) from use of cd when determining
-        $CATALINA_HOME in catalina.sh and tool-wrapper.sh scripts. Based on patch
-        provided by mdietze. (markt/kkolinko)
-      </fix>
-      <fix>
-        <bug>48895</bug>: Make clearing of ThreadLocals that are causing memory
-        leaks on web application stop, reload or undeploy configurable since the
-        process of clearing them is not thread-safe. (markt)
-      </fix>
-      <fix>
-        <bug>48903</bug>: Fix deadlock in webapp class loader. (rjung)
-      </fix>
-      <fix>
-        <bug>48971</bug>: Make stopping of leaking Timer threads optional and
-        disabled by default. (markt)
-      </fix>
-      <fix>
-        <bug>48976</bug>: Document JAVA_ENDORSED_DIRS in start-up scripts. Patch
-        provided by Laurent Vaills. (markt)
-      </fix>
-      <fix>
-        <bug>48983</bug>: Improve debug logging for situations when
-        <code>RemoteIpValve</code> is bypassed. Patch provided by Cyrille Le
-        Clerc. (markt)
-      </fix>
-      <fix>
-        <bug>49018</bug>: Fix processing of time argument in the Expire sessions
-        action in the Manager web application. (kkolinko)
-      </fix>
-      <fix>
-        <bug>49116</bug>: If session is already invalid, expire session to
-        prevent memory leak. (kfujino)
-      </fix>
-      <fix>
-        <bug>49158</bug>: Ensure only one session cookie is returned for a
-        single request. (markt/fhanik)
-      </fix>
-      <fix>
-        <bug>49245</bug>: Fix session expiration check in cross-context
-        requests. (markt)
-      </fix>
-      <fix>
-        <bug>49398</bug>: ByteChunk.indexOf(String, int, int, int) could not
-        find a string of length 1. (kkolinko)
-      </fix>
-      <fix>
-        Fix possible overflows when calculating session statistics. (kkolinko)
-      </fix>
-      <add>
-        Log unexpected exceptions when providing access to web application
-        resources in ApplicationContext. (kkolinko)
-      </add>
-      <fix>
-        Improve exception handling in CatalinaShutdownHook. (kkolinko)
-      </fix>
-      <add>
-        Expose properties of VirtualWebappLoader and WebappClassLoader via JMX.
-        (rjung)
-      </add>
-    </changelog>
-  </subsection>
-  <subsection name="Coyote">
-    <changelog>
-      <fix>
-        <bug>48839</bug>: Correctly handle HTTP header folding in the NIO
-        connector. Patch suggested by Richa Baronia. (markt)
-      </fix>
-      <fix>
-        <bug>48843</bug>: Prevent possible deadlock for worker allocation in
-        connectors. (kkolinko)
-      </fix>
-      <fix>
-        <bug>48843</bug>: Fix handling of add queues in AprEndpoint.Poller and
-        AprEndpoint.Sendfile. Do not miss wakeups. (kkolinko)
-      </fix>
-      <add>
-        <bug>48862</bug>: Add support for the backlog parameter to the AJP
-        connector. (pero/markt)
-      </add>
-      <fix>
-        <bug>48917</bug>: Correct name of mod_jk module in ApacheConfig. Patch
-        provided by Todd Hicks. (markt)
-      </fix>
-      <fix>
-        <bug>49095</bug>: AprEndpoint did not wakeup acceptors during shutdown
-        when deferAccept option was enabled. Based on a patch provided by
-        Ruediger Pluem. (kkolinko)
-      </fix>
-      <add>
-        Use chunked encoding for http 1.1 requests with no content-length
-        (regardless of keep-alive) so client can differentiate between complete
-        and partial responses. (markt)
-      </add>
-      <fix>
-        Correct the SSL session timeout attribute name so the code agrees with
-        the documentation. (markt)
-      </fix>
-      <add>
-        CoyotePrincipal now implements Serializable. (fhanik)
-      </add>
-      <fix>
-        Enable the BIO AJP connector to run under a security manager. (markt)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Jasper">
-    <changelog>
-      <fix>
-        <bug>45015</bug>: Correct a regression in quote handling caused by the
-        re-factoring of attribute parsing. (markt)
-      </fix>
-      <fix>
-        <bug>48701</bug>: Add a system property to allow disabling enforcement
-        of JSP.5.3. The specification recommends, but does not require, this
-        enforcement. (kkolinko)
-      </fix>
-      <fix>
-        <bug>48737</bug>: Don't assume paths that start with /META-INF/... are
-        always in JARs. This is not true for some IDEs. Patch provided by
-        Fabrizio Giustina. (markt)
-      </fix>
-      <fix>
-        <bug>49081</bug>: Correctly handle EL expressions of the form #${...}.
-        (markt)
-      </fix>
-      <fix>
-        <bug>49196</bug>: Avoid NullPointerException in PageContext.getErrorData()
-        if an error-handling JSP page is called directly. (markt)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Cluster">
-    <changelog>
-      <fix>
-        <bug>48717</bug>: When a node joins a cluster and it receives all the
-        current sessions, ensure the sessionCreated event is fired if the
-        Manager is configured to replicate session events. (markt)
-      </fix>
-      <fix>
-        <bug>48934</bug>: Previous fix to handle dropped connections incorrectly
-        permanently disabled session replication. (fhanik)
-      </fix>
-      <fix>
-        <bug>49051</bug>: memberAlive is not called if member has not already
-        existed in membership. (kfujino)
-      </fix>
-      <fix>
-        <bug>49151</bug>: Avoid ClassCastException in BackupManager#stop.
-        (kfujino)
-      </fix>
-      <fix>
-        <bug>49170</bug>: Do not send duplicated session. (kfujino)
-      </fix>
-      <fix>
-        Add missing messages and ensure cluster listeners log messages to
-        correct logger. (markt)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Web applications">
-    <changelog>
-      <add>
-        Use underscores instead of spaces in anchor names in Tomcat
-        documentation. (kkolinko)
-      </add>
-      <add>
-        Add support for displaying the Spring Security user name (if present) in
-        the Manager application. (markt)
-      </add>
-      <update>
-        Improve the ChatServlet <a href="aio.html">Comet</a> example
-        (/examples/jsp/chat/). (kkolinko)
-      </update>
-    </changelog>
-  </subsection>
-  <subsection name="Other">
-    <changelog>
-      <update>Update to Commons Daemon 1.0.2. Use service launcher (procrun)
-      from the Commons Daemon release. Do not keep a copy of it in our source
-      tree. (mturk/kkolinko)</update>
-      <update>
-        Update to NSIS 2.46. (kkolinko)
-      </update>
-      <fix>
-        <bug>48990</bug>: Fix the <code>skip.installer</code> build property
-        so if set, only the Windows installer is skipped. (markt)
-      </fix>
-      <fix>
-        <bug>49178</bug>: Provide in catalina.policy an example of additional
-        permissions that might be needed for code located in
-        <code>$CATALINA_BASE/lib</code>. (markt)
-      </fix>
-      <fix>
-        <bug>49236</bug>: Do not use indexing when packing Tomcat JARs.
-        (kkolinko)
-      </fix>
-      <fix>
-        Remove unused code from org.apache.tomcat.util.buf classes. (kkolinko)
-      </fix>
-      <update>
-        Rearrange tomcat-juli.jar permissions and wrap long lines in the
-        <code>conf/catalina.policy</code> file, to make the text more readable
-        when cited in documentation. (kkolinko)
-      </update>
-      <fix>
-        Do not evaluate the <code>execute.installer</code> property when building
-        a release. The <code>skip.installer</code> property is used instead.
-        (kkolinko)
-      </fix>
-    </changelog>
-  </subsection>
-</section>
-<section name="Tomcat 6.0.26 (jfclere)" rtext="released 2010-03-11">
-  <subsection name="Catalina">
-    <changelog>
-      <fix>
-        Close security hole in unreleased 6.0.25 by ensuring new find leaks
-        functionality is protected by a security constraint. (kkolinko)
-      </fix>
-      <fix>
-        <bug>48831</bug>: Improve logging shutdown behaviour. Use Catalina's
-        shutdown hook to shutdown JULI. This enables them to be shutdown in the
-        correct order. Do not shutdown global handlers several times.
-        (markt/kkolinko)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Coyote">
-    <changelog>
-      <fix>
-        <bug>48584</bug>: Prevent the APR connector logging an error if the
-        acceptor fails during shutdown since this is expected. (mturk)
-      </fix>
-      <fix>
-        <bug>48660</bug>: Using compression should not overwrite any Vary header
-        set by a web application. (markt)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Jasper">
-    <changelog>
-      <fix>
-        <bug>48371</bug>: Ensure generated servlet mappings are inserted at the
-        correct location when using JspC and allow the option that controls this
-        to be configured on the command line. Also allow the encoding of web.xml
-        to be configured when using JspC and deprecate some unused JspC methods.
-        (markt/kkolinko)
-      </fix>
-      <fix>
-        <bug>48498</bug>: Avoid ArrayIndexOutOfBoundsException triggered by a
-        Java 6/7 XML parser bug. (markt/kkolinko)
-      </fix>
-      <fix>
-        <bug>48668</bug>: Additional fixes to ensure deferred syntax is handled
-        correctly. (kkolinko)
-      </fix>
-      <fix>
-        <bug>48827</bug>: Correct a regression in the fix for <bug>47977</bug>
-        that caused an incorrect non-empty body error to be reported for valid
-        JSP documents. (markt)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Web applications">
-    <changelog>
-      <add>
-        Make changelog.xml be directly rendered as HTML by certain browsers.
-        (kkolinko)
-      </add>
-      <add>
-        Add support for automated generation of TOC tables and for links to svn
-        revisions to tomcat-docs.xsl in documentation. (kkolinko/fhanik)
-      </add>
-      <add>
-        Move Manager application JSPs that are not intended to be accessed
-        directly under the WEB-INF directory. (kkolinko)
-      </add>
-      <fix>
-        Improve the messages displayed by the find leaks diagnostic in the
-        Manager application. (kkolinko)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Other">
-    <changelog>
-      <fix>
-        Encode all property files using ascii escaped UTF-8. Also fixes
-        deployment problem when using French locale. (jfclere/rjung)
-      </fix>
-    </changelog>
-  </subsection>
-</section>
-<section name="Tomcat 6.0.25 (jfclere)" rtext="not released">
-  <subsection name="Catalina">
-    <changelog>
-      <fix>
-        <bug>48039</bug>: Return immediately if start() is called on an already
-        started StandardService. (markt)
-      </fix>
-      <fix>
-        <bug>48109</bug>: Ensure InputStream is closed on error condition in web
-        application class loader. (markt)
-      </fix>
-      <fix>
-        <bug>48179</bug>: Clean up dead code that was used to read tldCache
-        file. (kkolinko)
-      </fix>
-      <fix>
-        <bug>48318</bug>: Handle case where WebDAV resource is in directory
-        listing but is not accessible. (markt)
-      </fix>
-      <add>
-        <bug>48384</bug>: Add a per context xslt option for directory listings.
-        Make the fallback options work as described in the documentation.
-        (markt)
-      </add>
-      <fix>
-        <bug>48577</bug>: Filter URL when displaying missing included page.
-        (markt)
-      </fix>
-      <fix>
-        <bug>48612</bug>: Prevent exception on shutdown if the address attribute
-        is specified for a connector. (markt)
-      </fix>
-      <fix>
-        <bug>48613</bug>: Further fixes to ensure APRLifecycleListener is only
-        used if defined in server.xml. (fhanik)
-      </fix>
-      <fix>
-        <bug>48614</bug>: Correct JULI log file buffering so default behaviour
-        is no buffering. (fhanik)
-      </fix>
-      <fix>
-        <bug>48625</bug>: Provide an option to exit if an error occurs during
-        the initialization phase. (fhanik)
-      </fix>
-      <fix>
-        <bug>48645</bug>: Use specified encoding rather than null in calls to
-        <code>RequestUtil.URLDecode(byte[] bytes, String enc)</code> (markt)
-      </fix>
-      <fix>
-        <bug>48653</bug>: Force request.secure and request.scheme to
-        <code>false</code> and <code>http</code> if the X-Forwarded-Proto header
-        has the value http. Patch provided by Cyrille Le Clerc. (markt)
-      </fix>
-      <fix>
-        <bug>48678</bug>: Remove duplicate server field from
-        <code>org.apache.catalina.startup.Catalina</code>. (markt)
-      </fix>
-      <fix>
-        <bug>48694</bug>: Remove potential deadlock in web application class
-        loader. (markt)
-      </fix>
-      <add>
-        <bug>48716</bug>: Provide additional configuration options for JULI.
-        (markt)
-      </add>
-      <fix>
-        <bug>48726</bug>: Prevent OOME when uploading large WAR files with the
-        deployer. Patch provided by adam. (markt)
-      </fix>
-      <add>
-        Improve memory leak protection by safely stopping threads started via
-        <code>java.util.Timer</code> that an application starts but fails to
-        stop and by clearing references retained due to the use of
-        <code>java.util.ResourceBundle</code>. (markt)
-      </add>
-      <update>
-        Modify ThreadLocal memory leak detection to not report false positives
-        and to simplify implementation. (markt/kkolinko)
-      </update>
-      <add>
-        Basic memory leak detection was added to the standard Host
-        implementation and exposed via JMX to detect memory leaks on web
-        application reload. (markt/kkolinko)
-      </add>
-    </changelog>
-  </subsection>
-  <subsection name="Coyote">
-    <changelog>
-      <update>
-        Update the native/APR library version bundled with Tomcat to 1.1.20.
-        (kkolinko)
-      </update>
-    </changelog>
-  </subsection>
-  <subsection name="Jasper">
-    <changelog>
-      <add>
-        Add some debug logging to the compiler where exceptions were previously
-        swallowed. (markt)
-      </add>
-      <fix>
-        <bug>48170</bug>: Remove unnecessary synchronization that is causing
-        issues under load. (markt)
-      </fix>
-      <fix>
-        <bug>48580</bug>: Prevent AccessControlException if first access is to a
-        JSP that uses a FunctionMapper. (markt)
-      </fix>
-      <fix>
-        <bug>48582</bug>: Avoid NPE on background compilation failure. (markt)
-      </fix>
-      <fix>
-        <bug>48616</bug>: Don't declare or synchronize scripting variables for
-        JSP fragments since they are scriptless. This is an alternative fix for
-        <bug>42390</bug> that avoids both the original problem and the
-        regression in the first fix. (kkolinko)
-      </fix>
-      <fix>
-        <bug>48627</bug>: Fix regression in re-factored EL parsing. Keep
-        literals as literals and handle deferredSyntaxAllowedAsLiteral.
-        (kkolinko)
-      </fix>
-      <fix>
-        <bug>48668</bug>: When parsing JSPs only parse EL as EL if EL is enabled
-        else strings such as ${ will be silently dropped. (markt)
-      </fix>
-      <fix>
-        Various EL TCK failures. (markt)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Cluster">
-    <changelog>
-      <fix>
-        Force a disconnect if an error occurs during replication such as
-        a firewall dropping the connection. (fhanik)
-      </fix>
-    </changelog>
-  </subsection>
-  <subsection name="Web applications">
-    <changelog>
-      <add>
-        Add new "Find leaks" command to the Manager application. It allows to
-        detect web applications that have caused memory leaks on stop,
-        reload or undeploy. (markt/kkolinko)
-      </add>
-    </changelog>
-  </subsection>
-  <subsection name="Other">
-    <changelog>
-      <fix>
-        Ensure files in conf directory have CRLF line endings when using the
-        Windows installer. (kkolinko)
-      </fix>
-      <fix>
-        Allow special characters recognized by the Windows command-line shell to
-        be present in the names of CATALINA_HOME/_BASE and the current directory
-        used to call the Tomcat scripts. (kkolinko)
-      </fix>
-      <fix>
-        Don't use @Deprecated annotations in
-        <code>javax.servlet.jsp.JspContext</code> since the specification does
-        not include them in the API definition. (markt)
-      </fix>
-      <add>
-        Improve the information in the JAR manifest files. (markt)
-      </add>
-    </changelog>
-  </subsection>
-</section>
 <section name="Tomcat 6.0.24 (jfclere)" rtext="released 2010-01-21">
   <subsection name="Catalina">
     <changelog>
@@ -2654,6 +50,12 @@
         Correct TCK failures with security manager caused by the original fix
         for <bug>47774</bug>. (markt)
       </fix>
+      <fix>
+        CVE-2014-0227 applied by Red Hat
+        Various improvements to ChunkedInputFilter including clean-up, i18n for
+        error messages and adding an error flag to allow subsequent attempts at
+        reading after an error to fail fast. (markt)
+      </fix>
     </changelog>
   </subsection>
   <subsection name="Other">
--- java/org/apache/coyote/http11/filters/LocalStrings.properties.orig	2015-02-25 15:42:11.623832000 -0500
+++ java/org/apache/coyote/http11/filters/LocalStrings.properties	2015-02-25 14:13:29.428375000 -0500
@@ -0,0 +1,27 @@
+# Licensed to the Apache Software Foundation (ASF) under one or more
+# contributor license agreements.  See the NOTICE file distributed with
+# this work for additional information regarding copyright ownership.
+# The ASF licenses this file to You under the Apache License, Version 2.0
+# (the "License"); you may not use this file except in compliance with
+# the License.  You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+
+chunkedInputFilter.error=No data available due to previous error
+chunkedInputFilter.eos=Unexpected end of stream while reading request body
+chunkedInputFilter.eosTrailer=Unexpected end of stream while reading trailer headers
+chunkedInputFilter.invalidCrlf=Invalid end of line sequence (character other than CR or LF found)
+chunkedInputFilter.invalidCrlfCRCR=Invalid end of line sequence (CRCR)
+chunkedInputFilter.invalidCrlfNoCR=Invalid end of line sequence (No CR before LF)
+chunkedInputFilter.invalidCrlfNoData=Invalid end of line sequence (no data available to read)
+chunkedInputFilter.invalidHeader=Invalid chunk header
+chunkedInputFilter.maxExtension=maxExtensionSize exceeded
+chunkedInputFilter.maxTrailer=maxTrailerSize exceeded
+
+inputFilter.maxSwallow=maxSwallowSize exceeded
\ No newline at end of file

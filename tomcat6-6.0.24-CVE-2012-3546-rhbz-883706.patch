--- java/org/apache/catalina/realm/RealmBase.java.orig	2013-02-12 14:27:37.595525045 -0700
+++ java/org/apache/catalina/realm/RealmBase.java	2013-02-12 14:29:24.146802674 -0700
@@ -45,7 +45,6 @@
 import org.apache.catalina.connector.Request;
 import org.apache.catalina.connector.Response;
 import org.apache.catalina.core.ContainerBase;
-import org.apache.catalina.deploy.LoginConfig;
 import org.apache.catalina.deploy.SecurityConstraint;
 import org.apache.catalina.deploy.SecurityCollection;
 import org.apache.catalina.util.HexUtils;
@@ -735,31 +734,6 @@
         if (constraints == null || constraints.length == 0)
             return (true);
 
-        // Specifically allow access to the form login and form error pages
-        // and the "j_security_check" action
-        LoginConfig config = context.getLoginConfig();
-        if ((config != null) &&
-            (Constants.FORM_METHOD.equals(config.getAuthMethod()))) {
-            String requestURI = request.getRequestPathMB().toString();
-            String loginPage = config.getLoginPage();
-            if (loginPage.equals(requestURI)) {
-                if (log.isDebugEnabled())
-                    log.debug(" Allow access to login page " + loginPage);
-                return (true);
-            }
-            String errorPage = config.getErrorPage();
-            if (errorPage.equals(requestURI)) {
-                if (log.isDebugEnabled())
-                    log.debug(" Allow access to error page " + errorPage);
-                return (true);
-            }
-            if (requestURI.endsWith(Constants.FORM_ACTION)) {
-                if (log.isDebugEnabled())
-                    log.debug(" Allow access to username/password submission");
-                return (true);
-            }
-        }
-
         // Which user principal have we already authenticated?
         Principal principal = request.getPrincipal();
         boolean status = false;
--- ./webapps/docs/changelog.xml.orig	2013-02-13 12:06:46.785540061 -0700
+++ ./webapps/docs/changelog.xml	2013-02-13 12:11:28.263049312 -0700
@@ -36,7 +36,10 @@
 <section name="Tomcat 6.0.24 (jfclere)">
   <subsection name="Catalina">
     <changelog>
-
+	    <fix>
+		 	Remove unneeded handling of FORM authentication in RealmBase (kkolinko)
+			CVE-2012-3546 Patch backported to tc 6.0.24 by Red Hat
+       </fix>
        <fix>
 			<bug>52858</bug>: Fix high CPU load with SSL, NIO and sendfile when
 			client breaks the connection before reading all the requested data.

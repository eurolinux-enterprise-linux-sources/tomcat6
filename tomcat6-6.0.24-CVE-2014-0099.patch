--- java/org/apache/tomcat/util/buf/Ascii.java.orig	2014-06-18 11:49:26.508855000 -0400
+++ java/org/apache/tomcat/util/buf/Ascii.java	2014-06-19 17:39:11.759607000 -0400
@@ -41,6 +41,8 @@
     private static final boolean[] isWhite = new boolean[256];
     private static final boolean[] isDigit = new boolean[256];
 
+    private static final long OVERFLOW_LIMIT = Long.MAX_VALUE / 10;
+
     /*
      * Initialize character translation and type tables.
      */
@@ -196,19 +198,13 @@
         }
 
         long n = c - '0';
-        long m;
         
         while (--len > 0) {
-            if (!isDigit(c = b[off++])) {
-                throw new NumberFormatException();
-            }
-            m = n * 10 + c - '0';
-
-            if (m < n) {
-                // Overflow
-                throw new NumberFormatException();
+            if (isDigit(c= b[off++]) &&
+                (n < OVERFLOW_LIMIT || (n == OVERFLOW_LIMIT && (c-'0') < 8))) {
+                n = n * 10 + c - '0';
             } else {
-                n = m;
+                    throw new NumberFormatException();
             }
         }
 
--- webapps/docs/changelog.xml.orig	2014-06-18 11:49:26.532839000 -0400
+++ webapps/docs/changelog.xml	2014-06-18 12:02:18.787448000 -0400
@@ -192,6 +192,11 @@
             Better adhereence to RFC2616 for content-length headers (markt)
             CVE-2013-4286 patch applied by Red Hat
         </fix>
+       <fix>
+         CVE-2014-0099 - Fix possible overflow when parsing long values 
+         from a byte array. Patch applied by Red Hat
+         (markt)
+       </fix>
     </changelog>
   </subsection>
   <subsection name="Jasper">

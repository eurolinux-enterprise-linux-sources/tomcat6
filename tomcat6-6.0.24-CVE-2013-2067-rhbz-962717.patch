--- java/org/apache/catalina/authenticator/FormAuthenticator.java.orig	2013-06-11 17:05:33.893272000 -0400
+++ java/org/apache/catalina/authenticator/FormAuthenticator.java	2013-06-11 17:32:38.880547000 -0400
@@ -31,6 +31,7 @@
 import javax.servlet.http.HttpServletResponse;
 
 import org.apache.catalina.Globals;
+import org.apache.catalina.Manager;
 import org.apache.catalina.Realm;
 import org.apache.catalina.Session;
 import org.apache.catalina.connector.Request;
@@ -314,6 +315,21 @@
      */
     protected void forwardToLoginPage(Request request, Response response,
             LoginConfig config) throws IOException {
+
+       if (getChangeSessionIdOnAuthentication()) {
+           Session session = request.getSessionInternal(false);
+           if (session != null) {
+               Manager manager = request.getContext().getManager();
+               manager.changeSessionId(session);
+               request.changeSessionId(session.getId());
+           }
+       }
+
+       // Always use GET for the login page regardless of the 
+       // method used
+       String oldMethod = request.getCoyoteRequest().method().toString();
+       request.getCoyoteRequest().method().setString("GET");
+
         RequestDispatcher disp =
             context.getServletContext().getRequestDispatcher
             (config.getLoginPage());
@@ -326,6 +342,8 @@
             request.setAttribute(Globals.EXCEPTION_ATTR, t);
             response.sendError(HttpServletResponse.SC_INTERNAL_SERVER_ERROR,
                     msg);
+        } finally {
+            request.getCoyoteRequest().method().setString(oldMethod);
         }
     }
 
